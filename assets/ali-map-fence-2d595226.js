import{d as X,r as p,q as Y,S as Z,T as ee,e as I,o as w,f as N,k as t,g as a,w as o,J as le,K as ae,n as c,B as E,j as y,v as oe,A as C,U as te,P as ne,l as se,V as ie,p as ce,Q as de,R as re,_ as ue}from"./index-8e4d02bc.js";import{E as pe}from"./dialog-96ae45f8.js";/* empty css             */import{E as me,a as fe}from"./form-item-095d7a10.js";import{a as _e}from"./useMap-38c0b7de.js";import"./index-86a435be.js";const D=f=>(de("data-v-d485ecbb"),f=f(),re(),f),ve={class:"electronic"},ge=D(()=>t("div",{id:"map"},null,-1)),he={class:"navicon _flex _flex-align-center"},xe=D(()=>t("span",null,"电子围栏列表",-1)),ye=["onClick"],Ce={style:{color:"var(--el-color-info-light-3)"}},be={class:"list-item-operate"},ke={class:"form-element"},Ve={class:"btn _flex _flex-justify-between"},we={class:"search"},Ne={class:"dialog-footer"},Ee=X({__name:"ali-map-fence",setup(f){const b=p(""),k=p(!0),r=p([]),_=p(""),m=p(!1),v=p(!1),M=Y({fenceName:[{required:!0,message:"请输入电子围栏名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],fenceCode:[{required:!0,message:"请输入电子围栏编号",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]});Z(()=>{B()});const{currentData:n,isDraw:T,isInit:F,get:U,unmounted:$,initMap:L,renderData:j,removePolygon:z,viewPolygon:q,editPolygon:A,createDraw:G,findSearch:R,pushPolygon:J}=_e(r,()=>{C.error("111111")},i=>{C[i.status](i.msg)}),K=()=>{if(!T.value&&!n.id){C.warning("请先完成电子围栏绘制！");return}m.value=!0},Q=()=>{var i,e;n.fencePath=(e=(i=U("polyEditor"))==null?void 0:i.getTarget())==null?void 0:e._opts.path,v.value=!0,setTimeout(()=>{m.value=!1,v.value=!1;const u=Number(new Date);J(n.id?n.id:u);const{fenceCode:g,fenceName:h,fencePath:s}=n;r.value.some(d=>d.id===n.id)?r.value.forEach(d=>{d.id===n.id&&(d.fenceCode=g,d.fenceName=h,d.fencePath=s)}):r.value.push({fenceCode:g,fenceName:h,fencePath:s,id:u}),C.success("保存成功！")},1e3)},H=(i,e)=>{te.confirm('是否确认删除名称为"'+i.fenceName+'"的电子围栏?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z(e),r.value.splice(e,1)})},B=i=>{ee(i).then(e=>{e.data.data.length&&$(),r.value=e.data.data.map(u=>({...u,fencePath:u.fencePath})),F.value?j():L().then(()=>{console.log("初始化")})})};return(i,e)=>{const u=I("Back"),g=I("Guide"),h=ne,s=se,d=ie,x=ce,P=me,O=fe,W=pe;return w(),N("div",ve,[ge,t("div",{class:oe(["panel _flex _flex-justify-between",k.value?"":"pack-up"])},[t("div",he,[t("i",{class:"el-icon",style:{"margin-right":"10px"},onClick:e[0]||(e[0]=l=>k.value=!k.value)},[a(u)]),xe]),a(d,{class:"list-box"},{default:o(()=>[(w(!0),N(le,null,ae(r.value,(l,S)=>(w(),N("div",{class:"list-item _flex _flex-align-center _flex-justify-between pointer",key:S},[t("div",{onClick:V=>c(q)(l),class:"list-item-content _flex _flex-align-center"},[a(h,null,{default:o(()=>[a(g)]),_:1}),t("span",null,E(l.fenceName?l.fenceName:"未命名"),1),t("span",Ce,"（"+E(l.fenceCode)+"）",1)],8,ye),t("div",be,[a(s,{onClick:V=>c(A)(V,l),type:"primary",icon:"edit",size:"small"},null,8,["onClick"]),a(s,{onClick:V=>H(l,S),type:"danger",icon:"delete",size:"small"},null,8,["onClick"])])]))),128))]),_:1}),t("div",ke,[a(x,{placeholder:"查询电子围栏名称",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),maxlength:"10","show-word-limit":""},{append:o(()=>[a(s,{icon:"search",onClick:e[1]||(e[1]=l=>B(b.value))})]),_:1},8,["modelValue"]),t("div",Ve,[a(s,{type:"default",onClick:c(G)},{default:o(()=>[y("绘制新电子围栏")]),_:1},8,["onClick"]),a(s,{type:"primary",onClick:K},{default:o(()=>[y("保存")]),_:1})])])],2),t("div",we,[a(x,{type:"text",placeholder:"查询地址",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l)},{append:o(()=>[a(s,{icon:"search",onClick:e[3]||(e[3]=l=>_.value&&c(R)(_.value))})]),_:1},8,["modelValue"])]),a(W,{class:"save-dialog",modelValue:m.value,"onUpdate:modelValue":e[8]||(e[8]=l=>m.value=l),width:"300px","show-close":!1},{footer:o(()=>[t("span",Ne,[a(s,{onClick:e[7]||(e[7]=l=>m.value=!1),size:"small"},{default:o(()=>[y("取 消")]),_:1}),a(s,{loading:v.value,type:"primary",onClick:Q},{default:o(()=>[y(E(v.value?"保存中":"确 定"),1)]),_:1},8,["loading"])])]),default:o(()=>[a(O,{class:"form",model:c(n),rules:M,"label-position":"top"},{default:o(()=>[a(P,{prop:"fenceCode",label:"电子围栏编号",style:{width:"100%"}},{default:o(()=>[a(x,{modelValue:c(n).fenceCode,"onUpdate:modelValue":e[5]||(e[5]=l=>c(n).fenceCode=l),placeholder:"请输入电子围栏编号"},null,8,["modelValue"])]),_:1}),a(P,{prop:"fenceName",label:"电子围栏名称",style:{width:"100%"}},{default:o(()=>[a(x,{modelValue:c(n).fenceName,"onUpdate:modelValue":e[6]||(e[6]=l=>c(n).fenceName=l),placeholder:"请输入电子围栏名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const Te=ue(Ee,[["__scopeId","data-v-d485ecbb"]]);export{Te as default};
