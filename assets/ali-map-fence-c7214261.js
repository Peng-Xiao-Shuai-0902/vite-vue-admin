import{d as Q,l as m,k as W,O as X,bZ as ee,f as S,o as V,a as N,b as t,i as o,w as a,F as le,e as oe,m as c,t as E,p as y,j as ae,M as C,a0 as te,x as ne,I as se,bY as ie,N as ce,R as de,S as re,_ as ue}from"./index-22d7fef2.js";import{E as me}from"./dialog-43789b87.js";/* empty css             */import{a as pe,E as fe}from"./form-item-32b74ae5.js";import{u as _e}from"./useMap-8b750919.js";import"./index-29498fad.js";const M=f=>(de("data-v-e5124fb3"),f=f(),re(),f),ve={class:"electronic"},ge=M(()=>t("div",{id:"map"},null,-1)),he={class:"navicon _flex _flex-align-center"},xe=M(()=>t("span",null,"电子围栏列表",-1)),ye=["onClick"],Ce={style:{color:"var(--el-color-info-light-3)"}},be={class:"list-item-operate"},ke={class:"form-element"},we={class:"btn _flex _flex-justify-between"},Ve={class:"search"},Ne={class:"dialog-footer"},Ee=Q({__name:"ali-map-fence",setup(f){const b=m(""),k=m(!0),r=m([]),_=m(""),p=m(!1),v=m(!1),D=W({fenceName:[{required:!0,message:"请输入电子围栏名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],fenceCode:[{required:!0,message:"请输入电子围栏编号",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]});X(()=>{B()});const{currentData:n,isDraw:F,isInit:T,get:$,unmounted:L,initMap:U,renderData:j,removePolygon:z,viewPolygon:q,editPolygon:G,createDraw:R,findSearch:A,pushPolygon:O}=_e(r,()=>{C.error("111111")},i=>{C[i.status](i.msg)}),Y=()=>{if(!F.value&&!n.id){C.warning("请先完成电子围栏绘制！");return}p.value=!0},Z=()=>{var i,e;n.fencePath=(e=(i=$("polyEditor"))==null?void 0:i.getTarget())==null?void 0:e._opts.path,v.value=!0,setTimeout(()=>{p.value=!1,v.value=!1;const u=Number(new Date);O(n.id?n.id:u);const{fenceCode:g,fenceName:h,fencePath:s}=n;r.value.some(d=>d.id===n.id)?r.value.forEach(d=>{d.id===n.id&&(d.fenceCode=g,d.fenceName=h,d.fencePath=s)}):r.value.push({fenceCode:g,fenceName:h,fencePath:s,id:u}),C.success("保存成功！")},1e3)},H=(i,e)=>{te.confirm('是否确认删除名称为"'+i.fenceName+'"的电子围栏?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z(e),r.value.splice(e,1)})},B=i=>{ee(i).then(e=>{e.data.length&&L(),r.value=e.data.map(u=>({...u,fencePath:u.fencePath})),T.value?j():U().then(()=>{console.log("初始化")})})};return(i,e)=>{const u=S("Back"),g=S("Guide"),h=ne,s=se,d=ie,x=ce,I=pe,J=fe,K=me;return V(),N("div",ve,[ge,t("div",{class:ae(["panel _flex _flex-justify-between",k.value?"":"pack-up"])},[t("div",he,[t("i",{class:"el-icon",style:{"margin-right":"10px"},onClick:e[0]||(e[0]=l=>k.value=!k.value)},[o(u)]),xe]),o(d,{class:"list-box"},{default:a(()=>[(V(!0),N(le,null,oe(r.value,(l,P)=>(V(),N("div",{class:"list-item _flex _flex-align-center _flex-justify-between pointer",key:P},[t("div",{onClick:w=>c(q)(l),class:"list-item-content _flex _flex-align-center"},[o(h,null,{default:a(()=>[o(g)]),_:1}),t("span",null,E(l.fenceName?l.fenceName:"未命名"),1),t("span",Ce,"（"+E(l.fenceCode)+"）",1)],8,ye),t("div",be,[o(s,{onClick:w=>c(G)(w,l),type:"primary",icon:"edit",size:"small"},null,8,["onClick"]),o(s,{onClick:w=>H(l,P),type:"danger",icon:"delete",size:"small"},null,8,["onClick"])])]))),128))]),_:1}),t("div",ke,[o(x,{placeholder:"查询电子围栏名称",modelValue:b.value,"onUpdate:modelValue":e[2]||(e[2]=l=>b.value=l),maxlength:"10","show-word-limit":""},{append:a(()=>[o(s,{icon:"search",onClick:e[1]||(e[1]=l=>B(b.value))})]),_:1},8,["modelValue"]),t("div",we,[o(s,{type:"default",onClick:c(R)},{default:a(()=>[y("绘制新电子围栏")]),_:1},8,["onClick"]),o(s,{type:"primary",onClick:Y},{default:a(()=>[y("保存")]),_:1})])])],2),t("div",Ve,[o(x,{type:"text",placeholder:"查询地址",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l)},{append:a(()=>[o(s,{icon:"search",onClick:e[3]||(e[3]=l=>_.value&&c(A)(_.value))})]),_:1},8,["modelValue"])]),o(K,{class:"save-dialog",modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),width:"300px","show-close":!1},{footer:a(()=>[t("span",Ne,[o(s,{onClick:e[7]||(e[7]=l=>p.value=!1),size:"small"},{default:a(()=>[y("取 消")]),_:1}),o(s,{loading:v.value,type:"primary",onClick:Z},{default:a(()=>[y(E(v.value?"保存中":"确 定"),1)]),_:1},8,["loading"])])]),default:a(()=>[o(J,{class:"form",model:c(n),rules:D,"label-position":"top"},{default:a(()=>[o(I,{prop:"fenceCode",label:"电子围栏编号",style:{width:"100%"}},{default:a(()=>[o(x,{modelValue:c(n).fenceCode,"onUpdate:modelValue":e[5]||(e[5]=l=>c(n).fenceCode=l),placeholder:"请输入电子围栏编号"},null,8,["modelValue"])]),_:1}),o(I,{prop:"fenceName",label:"电子围栏名称",style:{width:"100%"}},{default:a(()=>[o(x,{modelValue:c(n).fenceName,"onUpdate:modelValue":e[6]||(e[6]=l=>c(n).fenceName=l),placeholder:"请输入电子围栏名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const Fe=ue(Ee,[["__scopeId","data-v-e5124fb3"]]);export{Fe as default};
