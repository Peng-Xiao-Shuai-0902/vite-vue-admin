import{d as X,l as m,k as Y,P as Z,bU as ee,f as S,o as V,a as N,b as t,i as a,w as o,F as le,e as ae,m as c,t as E,p as x,j as oe,M as y,a0 as te,x as ne,I as se,bT as ie,N as ce,S as de,T as re,_ as ue}from"./index-b02eb4b8.js";import{E as me}from"./dialog-1764b509.js";/* empty css             */import{a as pe,E as fe}from"./form-item-8774b5cd.js";import{u as _e}from"./useMap-76dfa363.js";import"./index-16c6d3a2.js";const M=f=>(de("data-v-d485ecbb"),f=f(),re(),f),ve={class:"electronic"},ge=M(()=>t("div",{id:"map"},null,-1)),he={class:"navicon _flex _flex-align-center"},be=M(()=>t("span",null,"电子围栏列表",-1)),xe=["onClick"],ye={style:{color:"var(--el-color-info-light-3)"}},Ce={class:"list-item-operate"},ke={class:"form-element"},we={class:"btn _flex _flex-justify-between"},Ve={class:"search"},Ne={class:"dialog-footer"},Ee=X({__name:"ali-map-fence",setup(f){const C=m(""),k=m(!0),r=m([]),_=m(""),p=m(!1),v=m(!1),T=Y({fenceName:[{required:!0,message:"请输入电子围栏名称",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],fenceCode:[{required:!0,message:"请输入电子围栏编号",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}]});Z(()=>{P()});const{currentData:n,isDraw:D,isInit:F,get:U,unmounted:$,initMap:L,renderData:j,removePolygon:z,viewPolygon:q,editPolygon:G,createDraw:A,findSearch:R,pushPolygon:H}=_e(r,()=>{y.error("111111")},i=>{y[i.status](i.msg)}),J=()=>{if(!D.value&&!n.id){y.warning("请先完成电子围栏绘制！");return}p.value=!0},K=()=>{var i,e;n.fencePath=(e=(i=U("polyEditor"))==null?void 0:i.getTarget())==null?void 0:e._opts.path,v.value=!0,setTimeout(()=>{p.value=!1,v.value=!1;const u=Number(new Date);H(n.id?n.id:u);const{fenceCode:g,fenceName:h,fencePath:s}=n;r.value.some(d=>d.id===n.id)?r.value.forEach(d=>{d.id===n.id&&(d.fenceCode=g,d.fenceName=h,d.fencePath=s)}):r.value.push({fenceCode:g,fenceName:h,fencePath:s,id:u}),y.success("保存成功！")},1e3)},O=(i,e)=>{te.confirm('是否确认删除名称为"'+i.fenceName+'"的电子围栏?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z(e),r.value.splice(e,1)})},P=i=>{ee(i).then(e=>{e.data.data.length&&$(),r.value=e.data.data.map(u=>({...u,fencePath:u.fencePath})),F.value?j():L().then(()=>{console.log("初始化")})})};return(i,e)=>{const u=S("Back"),g=S("Guide"),h=ne,s=se,d=ie,b=ce,B=pe,Q=fe,W=me;return V(),N("div",ve,[ge,t("div",{class:oe(["panel _flex _flex-justify-between",k.value?"":"pack-up"])},[t("div",he,[t("i",{class:"el-icon",style:{"margin-right":"10px"},onClick:e[0]||(e[0]=l=>k.value=!k.value)},[a(u)]),be]),a(d,{class:"list-box"},{default:o(()=>[(V(!0),N(le,null,ae(r.value,(l,I)=>(V(),N("div",{class:"list-item _flex _flex-align-center _flex-justify-between pointer",key:I},[t("div",{onClick:w=>c(q)(l),class:"list-item-content _flex _flex-align-center"},[a(h,null,{default:o(()=>[a(g)]),_:1}),t("span",null,E(l.fenceName?l.fenceName:"未命名"),1),t("span",ye,"（"+E(l.fenceCode)+"）",1)],8,xe),t("div",Ce,[a(s,{onClick:w=>c(G)(w,l),type:"primary",icon:"edit",size:"small"},null,8,["onClick"]),a(s,{onClick:w=>O(l,I),type:"danger",icon:"delete",size:"small"},null,8,["onClick"])])]))),128))]),_:1}),t("div",ke,[a(b,{placeholder:"查询电子围栏名称",modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=l=>C.value=l),maxlength:"10","show-word-limit":""},{append:o(()=>[a(s,{icon:"search",onClick:e[1]||(e[1]=l=>P(C.value))})]),_:1},8,["modelValue"]),t("div",we,[a(s,{type:"default",onClick:c(A)},{default:o(()=>[x("绘制新电子围栏")]),_:1},8,["onClick"]),a(s,{type:"primary",onClick:J},{default:o(()=>[x("保存")]),_:1})])])],2),t("div",Ve,[a(b,{type:"text",placeholder:"查询地址",modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=l=>_.value=l)},{append:o(()=>[a(s,{icon:"search",onClick:e[3]||(e[3]=l=>_.value&&c(R)(_.value))})]),_:1},8,["modelValue"])]),a(W,{class:"save-dialog",modelValue:p.value,"onUpdate:modelValue":e[8]||(e[8]=l=>p.value=l),width:"300px","show-close":!1},{footer:o(()=>[t("span",Ne,[a(s,{onClick:e[7]||(e[7]=l=>p.value=!1),size:"small"},{default:o(()=>[x("取 消")]),_:1}),a(s,{loading:v.value,type:"primary",onClick:K},{default:o(()=>[x(E(v.value?"保存中":"确 定"),1)]),_:1},8,["loading"])])]),default:o(()=>[a(Q,{class:"form",model:c(n),rules:T,"label-position":"top"},{default:o(()=>[a(B,{prop:"fenceCode",label:"电子围栏编号",style:{width:"100%"}},{default:o(()=>[a(b,{modelValue:c(n).fenceCode,"onUpdate:modelValue":e[5]||(e[5]=l=>c(n).fenceCode=l),placeholder:"请输入电子围栏编号"},null,8,["modelValue"])]),_:1}),a(B,{prop:"fenceName",label:"电子围栏名称",style:{width:"100%"}},{default:o(()=>[a(b,{modelValue:c(n).fenceName,"onUpdate:modelValue":e[6]||(e[6]=l=>c(n).fenceName=l),placeholder:"请输入电子围栏名称"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}});const De=ue(Ee,[["__scopeId","data-v-d485ecbb"]]);export{De as default};
