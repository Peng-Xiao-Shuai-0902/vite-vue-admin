import{f as e}from"./menu.5e37e767.js";import{l as t,e as r}from"./role.ee55865c.js";import{r as a,o as l,m as n,w as s,a as d,i as o,J as i}from"./vendor.3d9d29ae.js";import"./index.b2dc1a97.js";const h={data:()=>({menuTreeList:[],defaultProps:{children:"children",label:"title"},roleId:null}),watch:{"$route.query.roleId":{immediate:!0,deep:!0,handler(e){this.roleId=e,this.roleId&&(this.treeList(),this.getRoleMenu(this.roleId))}}},methods:{treeList(){e().then((e=>{this.menuTreeList=e.data}))},getRoleMenu(e){t(e).then((e=>{let t=e.data,r=[];if(null!=t&&t.length>0)for(let a=0;a<t.length;a++){let e=t[a];0!==e.parentId&&r.push(e.id)}this.$refs.tree.setCheckedKeys(r)}))},handleSave(){let e=this.$refs.tree.getCheckedNodes(),t=new Set;if(null!=e&&e.length>0)for(let r=0;r<e.length;r++){let a=e[r];t.add(a.id),0!==a.parentId&&t.add(a.parentId)}this.$confirm("是否分配菜单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=new FormData;e.append("roleId",this.roleId),e.append("menuIds",Array.from(t)),r(e).then((e=>{this.$message({message:"分配成功",type:"success",duration:1e3}),this.$router.back()}))}))},handleClear(){this.$refs.tree.setCheckedKeys([])}}},u={style:{"margin-top":"20px"},align:"center"},c=i("保存"),p=i("清空");h.render=function(e,t,r,i,h,m){const f=a("el-tree"),g=a("el-button"),I=a("el-card");return l(),n(I,{class:"form-container",shadow:"never"},{default:s((()=>[d(f,{data:h.menuTreeList,"show-checkbox":"","default-expand-all":"","node-key":"id",ref:"tree","highlight-current":"",props:h.defaultProps},null,8,["data","props"]),o("div",u,[d(g,{type:"primary",onClick:t[0]||(t[0]=e=>m.handleSave())},{default:s((()=>[c])),_:1}),d(g,{onClick:t[1]||(t[1]=e=>m.handleClear())},{default:s((()=>[p])),_:1})])])),_:1})};export default h;
