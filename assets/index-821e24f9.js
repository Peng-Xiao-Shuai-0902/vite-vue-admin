import{s as S,W as k,X as _,cP as V,Y as J,Z as Q,k as q,l as p,d as P,O as U,B as W,f as j,o as A,a as F,i as c,w as v,b as o,p as m,cn as $,bc as X,cm as Y,m as h,M as w,I as Z,E as G,S as H,T as K,_ as ee}from"./index-8a86c71c.js";const te=(s,i)=>S({url:"menu/list?parentId="+s,params:i}),ae=s=>S({url:"menu/remove",method:"delete",data:{ids:s}}),se={hidden:1,icon:"",id:0,level:0,name:"",parentId:0,sort:0,title:""},oe=()=>{const s=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"菜单名称",overflowTooltip:!0,props:[{prop:"title"}]},{label:"菜单级数",props:[{prop:"level",filters:[{key:0,value:"一级"},{key:1,value:"二级"},{key:2,value:"三级"}]}]},{label:"前端名称",props:[{prop:"name"}]},{label:"前端图标",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"是否显示",props:[{prop:"hidden",type:"switch",data:k({property:{activeValue:1,inactiveValue:0,inactiveText:"隐",activeText:"显"}})}]},{label:"排序",sortable:!0,props:[{prop:"sort"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",prop:"",data:k([{text:"查看下级",params:"query",property:{type:"primary",icon:_(V)}},{text:"编辑",params:"update",property:{type:"info",icon:_(J)}},{text:"删除",params:"remove",property:{type:"danger",icon:_(Q)}}])}]}],i=q({listQuery:{pageNum:1,pageSize:10},total:0,list:[]}),n=p({...se}),d=p(0),l=p([]),t=p([]),u=p(!1);return{header:s,powerfulTableData:i,currentForm:n,parentId:d,upParent:l,allList:t,isDialog:u}},x=s=>(H("data-v-abc8d48c"),s=s(),K(),s),ne={class:"app-container"},le={class:"operate-container"},re=x(()=>o("div",null,[o("i",{class:"el-icon-tickets"}),o("span",null,"数据列表")],-1)),ie=x(()=>o("i",{class:"el-icon-back"},null,-1)),pe=P({__name:"index",setup(s){const{header:i,powerfulTableData:n,currentForm:d,parentId:l,upParent:t,allList:u,isDialog:f}=oe(),b=U(),y=W(),r=()=>{te(l.value,n.listQuery).then(e=>{n.list=e.data.list,n.total=e.data.total})};r();const C=e=>{n.listQuery[e.prop]=e.order,r()},I=e=>{switch(e.componentName){case"switch":const a=e.row;b.userInfo.id==a.id&&a.status===0&&w.error("你的账号已被停用！");break}},N=({params:e,row:a})=>{switch(console.log(e,a),e){case"query":T(a);break;case"update":D(a);break;case"remove":B(a);break}},T=e=>{t.value.push(e),u.value=[t.value[t.value.length-1]],l.value=e.id,r()},D=e=>{f.value=!0,Object.assign(d,JSON.parse(JSON.stringify(e)))},B=e=>{ae([e.id]).then(()=>{w.success("删除成功！"),r()})},O=()=>{y.getRoutes().forEach(e=>{e.meta&&e.meta.id&&y.removeRoute(e.name)}),b.userInfoRequest()},E=()=>{n.listQuery.pageNum=1,l.value=t.value[t.value.length-1].parentId,u.value=[t.value[t.value.length-1]],t.value.splice(t.value.length-1,1),r()},z=()=>{f.value=!0;let e={parentId:l.value,hidden:0,sort:0};Object.assign(d,JSON.parse(JSON.stringify(e)))};return(e,a)=>{const g=Z,L=j("powerful-table"),M=G;return A(),F("div",ne,[c(M,{shadow:e.defaultData.cardShadow},{default:v(()=>[o("div",{class:"tipBox warning",style:{"margin-top":"0"}},[o("p",null,[m(" 修改、删除 菜单并不会直接改变侧边栏。需要重新调用接口。"),o("span",{class:"active",onClick:O},"点击"),m(" 刷新侧边栏 ")])]),o("div",le,[re,o("div",null,[c($,{name:"fadeOpticy"},{default:v(()=>[X(c(g,{type:"primary",class:"btn-add",onClick:a[0]||(a[0]=R=>E()),size:"small"},{default:v(()=>[ie,m("返回上级 ")]),_:1},512),[[Y,h(t).length>0]])]),_:1}),c(g,{type:"primary",class:"btn-add",onClick:a[1]||(a[1]=R=>z()),size:"small"},{default:v(()=>[m(" 添加 ")]),_:1})])]),o("div",null,[c(L,{ref:"menuTable",list:h(n).list,header:h(i),isSelect:!1,"pagination-property":{total:h(n).total},tableName:"menuTable",onSizeChange:r,onSortCustom:C,onComponentEvent:I,onBtnClick:N},null,8,["list","header","pagination-property"])])]),_:1},8,["shadow"])])}}});const de=ee(pe,[["__scopeId","data-v-abc8d48c"]]);export{de as default};
