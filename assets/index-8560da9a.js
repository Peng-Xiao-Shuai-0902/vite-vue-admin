import{s as J,V as k,X as C,Y as M,Z as X,k as E,l as V,W as Y,M as y,d as Z,u as q,f as G,o as c,a as h,i as r,w as o,b as n,p as m,m as s,F as S,e as N,h as x,t as H,c6 as K,c7 as P,I as ee,N as te,E as ae,ad as le,a2 as oe,a3 as se}from"./index-22d7fef2.js";import{E as re}from"./dialog-43789b87.js";/* empty css             */import{a as ne,E as ie}from"./form-item-32b74ae5.js";const pe=u=>J({url:"admin/roleList",params:u}),ue={icon:"",id:-1,roles:[],username:"",status:-1,createTime:""},de=()=>{const u=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"帐号",overflowTooltip:!0,props:[{prop:"username"}]},{label:"角色",props:[{type:"slot",prop:"",slotName:"roles"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:k({property:d=>({activeColor:Y.getters.getThemeColor,inactiveValue:0,activeValue:1,beforeChange:()=>(d.id==1&&y.warning("不允许停用！"),!0)})})}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",prop:"",data:k([{text:"分配角色",params:"occupyOne",property:{type:"primary",icon:C(M)}},{text:"删除",params:"remove",property:{type:"danger",icon:C(X)}}])}]}],g=E({role:!1,edit:!1}),i=E({list:[],header:u,total:0,listQuery:{pageNum:1,pageSize:10,username:""}}),l=V({...ue}),p=V([]);return{header:u,switchs:g,powerfulTableData:i,currentForm:l,roleLists:p}},ce={class:"app-container"},me={class:"operate-container"},fe=n("div",null,[n("i",{class:"el-icon-search"}),n("span",null,"筛选搜索")],-1),_e={style:{"margin-top":"15px"}},ge={class:"screenForm"},he=n("div",{class:"operate-container"},[n("div",null,[n("i",{class:"el-icon-tickets"}),n("span",null,"数据列表")])],-1),Ce=Z({__name:"index",setup(u){const{header:g,switchs:i,powerfulTableData:l,currentForm:p,roleLists:d}=de(),T=q(),f=()=>{K(l.listQuery).then(t=>{l.list=t.data.list,l.total=t.data.total})};(()=>{pe({pageNum:1,pageSize:100}).then(t=>{d.value=t.data.list})})(),f();const B=t=>{switch(t.componentName){case"switch":const e=t.row;T.state.user.userInfo.id==e.id&&e.status===0&&y.error("你的账号已被停用！");break}},D=({params:t,row:e})=>{switch(console.log(e),t){case"occupyOne":i.role=!0,Object.assign(p,JSON.parse(JSON.stringify(e)));break;case"remove":O(e);break}},O=t=>{P({ids:[t.id]}).then(e=>{y.success("删除成功！"),f()})},F=()=>{i.role=!1,l.list=l.list.map(t=>(t.id==p.value.id&&(t=p.value),t))},L=()=>{Object.keys(l.listQuery).forEach(t=>{["pageNum","pageSize"].indexOf(t)==-1&&(l.listQuery[t]="")})};return(t,e)=>{const _=ee,Q=te,R=ne,z=ie,v=ae,I=le,U=G("powerful-table"),$=oe,W=se,j=re;return c(),h("div",ce,[r(v,{class:"filter-container",style:{marginBottom:"20px"},shadow:t.defaultData.cardShadow},{default:o(()=>[n("div",me,[fe,n("div",null,[r(_,{style:{float:"right"},type:"primary",onClick:e[0]||(e[0]=a=>f())},{default:o(()=>[m(" 查询搜索 ")]),_:1}),r(_,{style:{float:"right","margin-right":"15px"},onClick:e[1]||(e[1]=a=>L())},{default:o(()=>[m(" 重置 ")]),_:1})])]),n("div",_e,[r(z,{inline:!0,model:s(l).listQuery},{default:o(()=>[n("div",ge,[r(R,{label:"名称："},{default:o(()=>[r(Q,{modelValue:s(l).listQuery.username,"onUpdate:modelValue":e[2]||(e[2]=a=>s(l).listQuery.username=a),placeholder:"请输入账号名",style:{width:"80%"},clearable:""},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["shadow"]),r(v,{shadow:t.defaultData.cardShadow},{default:o(()=>[he,n("div",null,[r(U,{ref:"menuTable",list:s(l).list,header:s(g),isSelect:!1,tableName:"menuTable","pagination-property":{total:s(l).total},onSizeChange:f,onComponentEvent:B,onBtnClick:D},{roles:o(({row:a})=>[(c(!0),h(S,null,N(a.roles,b=>(c(),x(I,{key:b,style:{"margin-right":"5px"}},{default:o(()=>{var w;return[m(H((w=s(d).filter(A=>A.value==b)[0])==null?void 0:w.label),1)]}),_:2},1024))),128))]),_:1},8,["list","header","pagination-property"])])]),_:1},8,["shadow"]),r(j,{title:"分配角色",modelValue:s(i).role,"onUpdate:modelValue":e[6]||(e[6]=a=>s(i).role=a),width:"30%"},{footer:o(()=>[r(_,{onClick:e[4]||(e[4]=a=>s(i).role=!1)},{default:o(()=>[m("取 消")]),_:1}),r(_,{type:"primary",onClick:e[5]||(e[5]=a=>F())},{default:o(()=>[m("确 定")]),_:1})]),default:o(()=>[r(W,{modelValue:s(p).roles,"onUpdate:modelValue":e[3]||(e[3]=a=>s(p).roles=a),multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:o(()=>[(c(!0),h(S,null,N(s(d),a=>(c(),x($,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}});export{Ce as default};
