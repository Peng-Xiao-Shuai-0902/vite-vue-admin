import{s as B,a8 as N,a9 as h,b8 as W,aa as G,ab as K,q as I,r as F,d as M,ai as H,S as X,A as w,_ as R,o as b,x as k,w as r,g as o,f as $,J as Y,K as Z,j as v,C as T,p as ee,af as te,ag as ae,l as O,b9 as le,a as oe,b as ne,e as re,k as m,ax as se,z as ue,aC as ie,n as g,ba as L,E as de}from"./index-d0d9e9f9.js";/* empty css             */import{E as pe,a as me}from"./radio-group-05e4172a.js";/* empty css              */import{_ as q}from"./index-bf29a05b.js";import{E as fe,a as ce}from"./form-item-e0a55f95.js";const ve=(t,e)=>B({url:"menu/list?parentId="+t,params:e}),ge=t=>B({url:"menu/remove",method:"delete",data:{ids:t}}),be=t=>B({url:"menu/update",method:"post",data:t}),j={hidden:1,icon:"",id:0,level:0,name:"",parentId:0,sort:0,title:""},ye=()=>{const t=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"菜单名称",overflowTooltip:!0,props:[{prop:"title"}]},{label:"菜单级数",props:[{prop:"level",filters:[{key:0,value:"一级"},{key:1,value:"二级"},{key:2,value:"三级"}]}]},{label:"前端名称",props:[{prop:"name"}]},{label:"前端图标",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"是否显示",props:[{prop:"hidden",type:"switch",data:N({property:{activeValue:1,inactiveValue:0,inactiveText:"隐",activeText:"显"}})}]},{label:"排序",sortable:!0,props:[{prop:"sort"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",prop:"",data:N([{text:"查看下级",params:"query",property:{type:"primary",icon:h(W)}},{text:"编辑",params:"update",property:{type:"info",icon:h(G)}},{text:"删除",params:"remove",property:{type:"danger",icon:h(K)}}])}]}],e=I({listQuery:{pageNum:1,pageSize:10},total:0,list:[]}),u=I({...j}),i=F(0),c=F([]),d=F([]),p=F(!1);return{header:t,powerfulTableData:e,currentForm:u,parentId:i,upParent:c,allList:d,isDialog:p}},Fe=M({components:{iconSelect:q},props:{dialog:{type:Boolean,default:!1},currentForm:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},emits:["update:currentForm","update:dialog","refresh"],setup(t,e){const u=I({...j}),i=F(null);return H(t.currentForm,s=>{Object.assign(u,s)},{immediate:!0}),{uploadForm:i,formData:u,close:()=>{e.emit("update:dialog",!1),e.emit("update:currentForm",{})},resetForm:()=>{i.value.resetFields(),e.emit("update:currentForm",{})},onSubmit:()=>{i.value.validate(s=>{if(s)X.confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{be(u).then(()=>{w.success("修改成功")})});else return w({message:"验证失败",type:"error",duration:1e3}),!1})},rules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入前端名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],icon:[{required:!0,message:"请输入前端图标",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}]}}}});function _e(t,e,u,i,c,d){const p=ee,s=fe,_=te,D=ae,f=q,E=pe,V=me,C=O,S=ce,A=le;return b(),k(A,{title:t.currentForm.id?"修改":"添加","model-value":t.dialog,direction:"rtl",ref:"drawer",onClose:t.close},{default:r(()=>[o(S,{model:t.formData,rules:t.rules,ref:"uploadForm","label-position":"top",style:{padding:"0 20px"},class:"Dform"},{default:r(()=>[o(s,{label:"菜单名称：",prop:"title"},{default:r(()=>[o(p,{modelValue:t.formData.title,"onUpdate:modelValue":e[0]||(e[0]=n=>t.formData.title=n)},null,8,["modelValue"])]),_:1}),o(s,{label:"上级菜单："},{default:r(()=>[o(D,{modelValue:t.formData.parentId,"onUpdate:modelValue":e[1]||(e[1]=n=>t.formData.parentId=n),style:{width:"100%"},placeholder:"请选择菜单"},{default:r(()=>[(b(!0),$(Y,null,Z(t.selectMenuList,n=>(b(),k(_,{key:n.id,label:n.title,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"前端名称：",prop:"name"},{default:r(()=>[o(p,{modelValue:t.formData.name,"onUpdate:modelValue":e[2]||(e[2]=n=>t.formData.name=n)},null,8,["modelValue"])]),_:1}),o(s,{label:"前端图标：",prop:"icon"},{default:r(()=>[o(f,{style:{width:"100%"},icon:t.formData.icon,"onUpdate:icon":e[3]||(e[3]=n=>t.formData.icon=n),type:"element"},null,8,["icon"])]),_:1}),o(s,{label:"是否显示："},{default:r(()=>[t.dialog?(b(),k(V,{key:0,modelValue:t.formData.hidden,"onUpdate:modelValue":e[4]||(e[4]=n=>t.formData.hidden=n)},{default:r(()=>[o(E,{label:0},{default:r(()=>e[8]||(e[8]=[v("是")])),_:1}),o(E,{label:1},{default:r(()=>e[9]||(e[9]=[v("否")])),_:1})]),_:1},8,["modelValue"])):T("",!0)]),_:1}),o(s,{label:"排序："},{default:r(()=>[o(p,{modelValue:t.formData.sort,"onUpdate:modelValue":e[5]||(e[5]=n=>t.formData.sort=n)},null,8,["modelValue"])]),_:1}),o(s,null,{default:r(()=>[o(C,{type:"primary",onClick:e[6]||(e[6]=n=>t.onSubmit())},{default:r(()=>e[10]||(e[10]=[v("提交")])),_:1}),t.formData.id?T("",!0):(b(),k(C,{key:0,onClick:e[7]||(e[7]=n=>t.resetForm())},{default:r(()=>e[11]||(e[11]=[v("重置")])),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","model-value","onClose"])}const De=R(Fe,[["render",_e]]),Ee={class:"app-container"},Ce={class:"operate-container"},ke=M({__name:"index",setup(t){const{header:e,powerfulTableData:u,currentForm:i,parentId:c,upParent:d,allList:p,isDialog:s}=ye(),_=oe(),D=ne(),f=()=>{ve(c.value,u.listQuery).then(l=>{u.list=l.data.data.list,u.total=l.data.data.total})};f();const E=l=>{u.listQuery[l.prop]=l.order,f()},V=l=>{switch(l.componentName){case"switch":const a=l.row;_.userInfo.id==a.id&&a.status===0&&w.error("你的账号已被停用！");break}},C=({params:l,row:a})=>{switch(console.log(l,a),l){case"query":S(a);break;case"update":A(a);break;case"remove":n(a);break}},S=l=>{d.value.push(l),p.value=[d.value[d.value.length-1]],c.value=l.id,f()},A=l=>{s.value=!0,Object.assign(i,JSON.parse(JSON.stringify(l)))},n=l=>{ge([l.id]).then(()=>{w.success("删除成功！"),f()})},x=()=>{D.getRoutes().forEach(l=>{l.meta&&l.meta.id&&D.removeRoute(l.name)}),_.userInfoRequest()},z=()=>{u.listQuery.pageNum=1,c.value=d.value[d.value.length-1].parentId,p.value=[d.value[d.value.length-1]],d.value.splice(d.value.length-1,1),f()},Q=()=>{s.value=!0,p.value=p.value.length?p.value:[{id:i.parentId||0,title:i.title||"无上级菜单"}],Object.assign(i,{parentId:c.value,hidden:0,sort:0})};return(l,a)=>{const U=O,J=re("powerful-table"),P=de;return b(),$("div",Ee,[o(P,{shadow:l.defaultData.cardShadow},{default:r(()=>[m("div",{class:"tipBox warning",style:{"margin-top":"0"}},[m("p",null,[a[4]||(a[4]=v(" 修改、删除 菜单并不会直接改变侧边栏。需要重新调用接口。")),m("span",{class:"active",onClick:x},"点击"),a[5]||(a[5]=v(" 刷新侧边栏 "))])]),m("div",Ce,[a[8]||(a[8]=m("div",null,[m("i",{class:"el-icon-tickets"}),m("span",null,"数据列表")],-1)),m("div",null,[o(se,{name:"fadeOpticy"},{default:r(()=>[ue(o(U,{type:"primary",class:"btn-add",onClick:a[0]||(a[0]=y=>z())},{default:r(()=>a[6]||(a[6]=[m("i",{class:"el-icon-back"},null,-1),v("返回上级 ")])),_:1},512),[[ie,g(d).length>0]])]),_:1}),o(U,{type:"primary",class:"btn-add",onClick:a[1]||(a[1]=y=>Q())},{default:r(()=>a[7]||(a[7]=[v(" 添加 ")])),_:1})])]),m("div",null,[o(J,{ref:"menuTable",list:g(u).list,header:g(e),isSelect:!1,"pagination-property":{total:g(u).total},tableName:"menuTable",onSizeChange:f,onSortCustom:E,onComponentEvent:V,onBtnClick:C},null,8,["list","header","pagination-property"])])]),_:1},8,["shadow"]),o(De,{dialog:g(s),"onUpdate:dialog":a[2]||(a[2]=y=>L(s)?s.value=y:null),currentForm:g(i),"onUpdate:currentForm":a[3]||(a[3]=y=>L(i)?i.value=y:null),selectMenuList:g(p),onRefresh:f},null,8,["dialog","currentForm","selectMenuList"])])}}});const Be=R(ke,[["__scopeId","data-v-5791f3d5"]]);export{Be as default};
