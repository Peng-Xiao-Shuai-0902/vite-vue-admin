import{s as S,V as k,W as R,X as f,cP as J,Y as Q,Z as P,k as W,l as p,d as j,u as q,B as A,f as F,o as U,a as $,i as c,w as v,b as o,p as m,cn as X,bc as Y,cm as Z,m as h,M as w,I as G,E as H,R as K,S as ee,_ as te}from"./index-22d7fef2.js";const ae=(s,i)=>S({url:"menu/list?parentId="+s,params:i}),se=s=>S({url:"menu/remove",method:"delete",data:{ids:s}}),oe={hidden:1,icon:"",id:0,level:0,name:"",parentId:0,sort:0,title:""},ne=()=>{const s=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"菜单名称",overflowTooltip:!0,props:[{prop:"title"}]},{label:"菜单级数",props:[{prop:"level",filters:[{key:0,value:"一级"},{key:1,value:"二级"},{key:2,value:"三级"}]}]},{label:"前端名称",props:[{prop:"name"}]},{label:"前端图标",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"是否显示",props:[{prop:"hidden",type:"switch",data:k({property:{activeValue:1,inactiveValue:0,activeColor:R.getters.getThemeColor,inactiveText:"隐",activeText:"显"}})}]},{label:"排序",sortable:!0,props:[{prop:"sort"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",prop:"",data:k([{text:"查看下级",params:"query",property:{type:"primary",icon:f(J)}},{text:"编辑",params:"update",property:{type:"info",icon:f(Q)}},{text:"删除",params:"remove",property:{type:"danger",icon:f(P)}}])}]}],i=W({listQuery:{pageNum:1,pageSize:10},total:0,list:[]}),n=p({...oe}),d=p(0),l=p([]),a=p([]),u=p(!1);return{header:s,powerfulTableData:i,currentForm:n,parentId:d,upParent:l,allList:a,isDialog:u}},x=s=>(K("data-v-2dda4fee"),s=s(),ee(),s),le={class:"app-container"},re={class:"operate-container"},ie=x(()=>o("div",null,[o("i",{class:"el-icon-tickets"}),o("span",null,"数据列表")],-1)),pe=x(()=>o("i",{class:"el-icon-back"},null,-1)),ce=j({__name:"index",setup(s){const{header:i,powerfulTableData:n,currentForm:d,parentId:l,upParent:a,allList:u,isDialog:_}=ne(),y=q(),b=A(),r=()=>{ae(l.value,n.listQuery).then(e=>{n.list=e.data.list,n.total=e.data.total})};r();const C=e=>{n.listQuery[e.prop]=e.order,r()},I=e=>{switch(e.componentName){case"switch":const t=e.row;y.state.user.userInfo.id==t.id&&t.status===0&&w.error("你的账号已被停用！");break}},N=({params:e,row:t})=>{switch(console.log(e,t),e){case"query":T(t);break;case"update":D(t);break;case"remove":B(t);break}},T=e=>{a.value.push(e),u.value=[a.value[a.value.length-1]],l.value=e.id,r()},D=e=>{_.value=!0,Object.assign(d,JSON.parse(JSON.stringify(e)))},B=e=>{se([e.id]).then(t=>{w.success("删除成功！"),r()})},E=()=>{b.getRoutes().forEach(e=>{e.meta&&e.meta.id&&b.removeRoute(e.name)}),y.dispatch("userInfo")},O=()=>{n.listQuery.pageNum=1,l.value=a.value[a.value.length-1].parentId,u.value=[a.value[a.value.length-1]],a.value.splice(a.value.length-1,1),r()},V=()=>{_.value=!0;let e={parentId:l.value,hidden:0,sort:0};Object.assign(d,JSON.parse(JSON.stringify(e)))};return(e,t)=>{const g=G,z=F("powerful-table"),L=H;return U(),$("div",le,[c(L,{shadow:e.defaultData.cardShadow},{default:v(()=>[o("div",{class:"tipBox warning",style:{"margin-top":"0"}},[o("p",null,[m("修改、删除 菜单并不会直接改变侧边栏。需要重新调用接口。"),o("span",{class:"active",onClick:E},"点击"),m(" 刷新侧边栏")])]),o("div",re,[ie,o("div",null,[c(X,{name:"fadeOpticy"},{default:v(()=>[Y(c(g,{type:"primary",class:"btn-add",onClick:t[0]||(t[0]=M=>O()),size:"small"},{default:v(()=>[pe,m("返回上级 ")]),_:1},512),[[Z,h(a).length>0]])]),_:1}),c(g,{type:"primary",class:"btn-add",onClick:t[1]||(t[1]=M=>V()),size:"small"},{default:v(()=>[m(" 添加 ")]),_:1})])]),o("div",null,[c(z,{ref:"menuTable",list:h(n).list,header:h(i),isSelect:!1,"pagination-property":{total:h(n).total},tableName:"menuTable",onSizeChange:r,onSortCustom:C,onComponentEvent:I,onBtnClick:N},null,8,["list","header","pagination-property"])])]),_:1},8,["shadow"])])}}});const ue=te(ce,[["__scopeId","data-v-2dda4fee"]]);export{ue as default};
