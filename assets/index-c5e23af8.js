import{s as W,u as q,ae as C,af as S,ag as K,ah as M,q as E,r as V,A as v,d as G,a as H,e as P,o as d,f as y,g as r,w as o,k as n,j as c,n as s,J as x,K as N,x as B,B as X,ai as Y,aj as Z,l as ee,p as te,E as ae,ak as le,a3 as oe,a4 as se}from"./index-e341999d.js";import{E as re}from"./dialog-dbfdedb2.js";/* empty css             */import{E as ne,a as ie}from"./form-item-6cb2f183.js";const pe=m=>W({url:"admin/roleList",params:m}),ue={icon:"",id:-1,roles:[],username:"",status:-1,createTime:""},de=()=>{const m=q(),f=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"帐号",overflowTooltip:!0,props:[{prop:"username"}]},{label:"角色",props:[{type:"slot",prop:"",slotName:"roles"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:C({property:h=>({activeColor:m.themeColor.primary,inactiveValue:0,activeValue:1,beforeChange:()=>(h.id==1&&v.warning("不允许停用！"),!0)})})}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",prop:"",data:C([{text:"分配角色",params:"occupyOne",property:{type:"primary",icon:S(K)}},{text:"删除",params:"remove",property:{type:"danger",icon:S(M)}}])}]}],i=E({role:!1,edit:!1}),l=E({list:[],header:f,total:0,listQuery:{pageNum:1,pageSize:10,username:""}}),p=V({...ue}),u=V([]);return{header:f,switchs:i,powerfulTableData:l,currentForm:p,roleLists:u}},ce={class:"app-container"},me={class:"operate-container"},fe=n("div",null,[n("i",{class:"el-icon-search"}),n("span",null,"筛选搜索")],-1),_e={style:{"margin-top":"15px"}},ge={class:"screenForm"},he=n("div",{class:"operate-container"},[n("div",null,[n("i",{class:"el-icon-tickets"}),n("span",null,"数据列表")])],-1),Ce=G({__name:"index",setup(m){const{header:f,switchs:i,powerfulTableData:l,currentForm:p,roleLists:u}=de(),h=H(),_=()=>{Y(l.listQuery).then(t=>{l.list=t.data.data.list,l.total=t.data.data.total})};(()=>{pe({pageNum:1,pageSize:100}).then(t=>{u.value=t.data.data.list})})(),_();const T=t=>{switch(t.componentName){case"switch":const e=t.row;h.userInfo.id==e.id&&e.status===0&&v.error("你的账号已被停用！");break}},D=({params:t,row:e})=>{switch(console.log(e),t){case"occupyOne":i.role=!0,Object.assign(p,JSON.parse(JSON.stringify(e)));break;case"remove":O(e);break}},O=t=>{Z({ids:[t.id]}).then(()=>{v.success("删除成功！"),_()})},R=()=>{i.role=!1,l.list=l.list.map(t=>(t.id==p.value.id&&(t=p.value),t))},L=()=>{Object.keys(l.listQuery).forEach(t=>{["pageNum","pageSize"].indexOf(t)==-1&&(l.listQuery[t]="")})};return(t,e)=>{const g=ee,Q=te,F=ne,U=ie,b=ae,j=le,z=P("powerful-table"),$=oe,I=se,J=re;return d(),y("div",ce,[r(b,{class:"filter-container",style:{marginBottom:"20px"},shadow:t.defaultData.cardShadow},{default:o(()=>[n("div",me,[fe,n("div",null,[r(g,{style:{float:"right"},type:"primary",onClick:e[0]||(e[0]=a=>_())},{default:o(()=>[c(" 查询搜索 ")]),_:1}),r(g,{style:{float:"right","margin-right":"15px"},onClick:e[1]||(e[1]=a=>L())},{default:o(()=>[c(" 重置 ")]),_:1})])]),n("div",_e,[r(U,{inline:!0,model:s(l).listQuery},{default:o(()=>[n("div",ge,[r(F,{label:"名称："},{default:o(()=>[r(Q,{modelValue:s(l).listQuery.username,"onUpdate:modelValue":e[2]||(e[2]=a=>s(l).listQuery.username=a),placeholder:"请输入账号名",style:{width:"80%"},clearable:""},null,8,["modelValue"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["shadow"]),r(b,{shadow:t.defaultData.cardShadow},{default:o(()=>[he,n("div",null,[r(z,{ref:"menuTable",list:s(l).list,header:s(f),isSelect:!1,tableName:"menuTable","pagination-property":{total:s(l).total},onSizeChange:_,onComponentEvent:T,onBtnClick:D},{roles:o(({row:a})=>[(d(!0),y(x,null,N(a.roles,w=>(d(),B(j,{key:w,style:{"margin-right":"5px"}},{default:o(()=>{var k;return[c(X((k=s(u).filter(A=>A.value==w)[0])==null?void 0:k.label),1)]}),_:2},1024))),128))]),_:1},8,["list","header","pagination-property"])])]),_:1},8,["shadow"]),r(J,{title:"分配角色",modelValue:s(i).role,"onUpdate:modelValue":e[6]||(e[6]=a=>s(i).role=a),width:"30%"},{footer:o(()=>[r(g,{onClick:e[4]||(e[4]=a=>s(i).role=!1)},{default:o(()=>[c("取 消")]),_:1}),r(g,{type:"primary",onClick:e[5]||(e[5]=a=>R())},{default:o(()=>[c("确 定")]),_:1})]),default:o(()=>[r(I,{modelValue:s(p).roles,"onUpdate:modelValue":e[3]||(e[3]=a=>s(p).roles=a),multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:o(()=>[(d(!0),y(x,null,N(s(u),a=>(d(),B($,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}});export{Ce as default};
