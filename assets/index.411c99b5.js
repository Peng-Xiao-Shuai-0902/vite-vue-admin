import{s as e}from"./index.41a3e251.js";import{_ as t,r as a,o as l,l as o,w as r,a as n,c as i,g as u,F as d,k as s,I as m,d as p,G as c,y as g,i as h,p as f,m as v,v as b,q as y,s as F,E as w}from"./vendor.d1cffd1a.js";import{i as _}from"./index.c46ce5a2.js";function x(t){return e({url:"menu/update",method:"post",data:t})}const V=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"菜单名称",overflowTooltip:!0,props:[{prop:"title"}]},{label:"菜单级数",props:[{prop:"level",filter:[{key:0,value:"一级"},{key:1,value:"二级"}]}]},{label:"前端名称",props:[{prop:"name"}]},{label:"前端图标",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"是否显示",props:[{prop:"hidden",type:"switch",data:{activeValue:0,inactiveValue:1,activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"排序",sortable:!0,props:[{prop:"sort"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",data:[{tip:"查看下级",type:"primary",icon:"el-icon-view",emit:"query"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],S={name:"MenuDetail",components:{iconSelect:_},props:{dialog:{type:Boolean,default:!1},currentFrom:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},data:()=>({rules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入前端名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],icon:[{required:!0,message:"请输入前端图标",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}]}}),emits:["update:currentFrom","update:dialog","refresh"],methods:{close(){this.$emit("update:dialog",!1),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})},onSubmit(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"验证失败",type:"error",duration:1e3}),!1;this.$confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{x(this.currentFrom).then((e=>{this.$message({message:"修改成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})),setTimeout((()=>{this.$emit("refresh")}),300)}))}))},resetForm(e){this.$refs[e].resetFields(),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})}}},U=m("是"),k=m("否"),C=m("提交"),$=m("重置");const I=[{id:0,title:"无上级菜单"}],L=p({components:{update:t(S,[["render",function(e,t,m,p,c,g){const h=a("el-input"),f=a("el-form-item"),v=a("el-option"),b=a("el-select"),y=a("icon-select"),F=a("el-radio"),w=a("el-radio-group"),_=a("el-button"),x=a("el-form"),V=a("el-drawer");return l(),o(V,{title:m.currentFrom.id?"修改":"添加",modelValue:m.dialog,"onUpdate:modelValue":t[8]||(t[8]=e=>m.dialog=e),direction:"rtl",ref:"drawer",onClose:g.close},{default:r((()=>[n(x,{model:m.currentFrom,rules:c.rules,ref:"menuFrom","label-width":"100px",style:{padding:"0 20px"}},{default:r((()=>[n(f,{label:"菜单名称：",prop:"title"},{default:r((()=>[n(h,{modelValue:m.currentFrom.title,"onUpdate:modelValue":t[0]||(t[0]=e=>m.currentFrom.title=e)},null,8,["modelValue"])])),_:1}),n(f,{label:"上级菜单："},{default:r((()=>[n(b,{modelValue:m.currentFrom.parentId,"onUpdate:modelValue":t[1]||(t[1]=e=>m.currentFrom.parentId=e),style:{width:"100%"},placeholder:"请选择菜单"},{default:r((()=>[(l(!0),i(d,null,u(m.selectMenuList,(e=>(l(),o(v,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(f,{label:"前端名称：",prop:"name"},{default:r((()=>[n(h,{modelValue:m.currentFrom.name,"onUpdate:modelValue":t[2]||(t[2]=e=>m.currentFrom.name=e)},null,8,["modelValue"])])),_:1}),n(f,{label:"前端图标：",prop:"icon"},{default:r((()=>[n(y,{icon:m.currentFrom.icon,"onUpdate:icon":t[3]||(t[3]=e=>m.currentFrom.icon=e)},null,8,["icon"])])),_:1}),n(f,{label:"是否显示："},{default:r((()=>[m.dialog?(l(),o(w,{key:0,modelValue:m.currentFrom.hidden,"onUpdate:modelValue":t[4]||(t[4]=e=>m.currentFrom.hidden=e)},{default:r((()=>[n(F,{label:0},{default:r((()=>[U])),_:1}),n(F,{label:1},{default:r((()=>[k])),_:1})])),_:1},8,["modelValue"])):s("",!0)])),_:1}),n(f,{label:"排序："},{default:r((()=>[n(h,{modelValue:m.currentFrom.sort,"onUpdate:modelValue":t[5]||(t[5]=e=>m.currentFrom.sort=e)},null,8,["modelValue"])])),_:1}),n(f,null,{default:r((()=>[n(_,{type:"primary",onClick:t[6]||(t[6]=e=>g.onSubmit("menuFrom"))},{default:r((()=>[C])),_:1}),m.currentFrom.id?s("",!0):(l(),o(_,{key:0,onClick:t[7]||(t[7]=e=>g.resetForm("menuFrom"))},{default:r((()=>[$])),_:1}))])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue","onClose"])}]])},setup(){const{proxy:t}=w();let a=c({value:[]}),l=c({value:[]});console.log(l.value);let o=g(0),r=c(V),n=c({pageNum:1,pageSize:10}),i=g(0),u=c({value:[]}),d=g(!1),s=c({value:{}});function m(t){0==i.value&&(u.value=[I],l.value=I),Object.assign(n,t||n),function(t,a){return e({url:"menu/list?parentId="+t,params:a})}(i.value,n).then((e=>{console.log(e),a.value=c(e.data.list),o.value=e.data.total}))}return m(),{list:a,total:o,config:r,listQuery:n,parentId:i,upParent:u,isDialog:d,currentFrom:s,allList:l,handleAddMenu:function(){d.value=!0,s.value={parentId:i.value,hidden:0,sort:0},console.log("添加",s)},getList:m,backUp:function(){n.pageNum=1,i.value=u.value[u.value.length-1][0].parentId,l.value=u.value[u.value.length-1],u.value.splice(u.value.length-1,1),m()},handleHiddenChange:function(e){x(e).then((e=>{t.$message({message:"修改成功",type:"success",duration:1e3})}))},handleShowNextLevel:function({row:e,index:t}){console.log(u.value),u.value.push([e]),l.value=u.value[u.value.length-1],i.value=e.id,m()},handleUpdate:function({row:e,index:t}){d.value=!0,s.value=c(JSON.parse(JSON.stringify(e)))},handleDelete:function({row:a,index:l}){var o;(o=[a.id],e({url:"menu/remove",method:"delete",data:{ids:o}})).then((e=>{t.$message({message:"删除成功",type:"success",duration:1e3}),m()}))}}}}),D=e=>(y("data-v-1b79b860"),e=e(),F(),e),T={class:"app-container"},M={class:"operate-container"},N=D((()=>h("div",null,[h("i",{class:"el-icon-tickets"}),h("span",null,"数据列表")],-1))),z=D((()=>h("i",{class:"el-icon-back"},null,-1))),j=m("返回上级 "),q=m(" 添加 ");var O=t(L,[["render",function(e,t,o,u,d,s){const m=a("el-button"),p=a("el-card"),c=a("powerful-table"),g=a("update");return l(),i("div",T,[n(p,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:r((()=>[h("div",M,[N,h("div",null,[n(f,{name:"fadeOpticy"},{default:r((()=>[v(n(m,{type:"primary",class:"btn-add",onClick:t[0]||(t[0]=t=>e.backUp()),size:"mini"},{default:r((()=>[z,j])),_:1},512),[[b,e.upParent.value.length>1]])])),_:1}),n(m,{type:"primary",class:"btn-add",onClick:t[1]||(t[1]=t=>e.handleAddMenu()),size:"mini"},{default:r((()=>[q])),_:1})])])])),_:1},8,["shadow"]),n(p,{shadow:e.defaultData.cardShadow},{default:r((()=>[h("div",null,[n(c,{ref:"menuTable",list:e.list.value,header:e.config,isSelect:!1,total:e.total,tableName:"menuTable",onSizeChange:e.getList,onSwitchChange:e.handleHiddenChange,onQuery:e.handleShowNextLevel,onUpdate:e.handleUpdate,onRemove:e.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onQuery","onUpdate","onRemove"])])])),_:1},8,["shadow"]),n(g,{dialog:e.isDialog,"onUpdate:dialog":t[2]||(t[2]=t=>e.isDialog=t),currentFrom:e.currentFrom.value,"onUpdate:currentFrom":t[3]||(t[3]=t=>e.currentFrom.value=t),selectMenuList:e.allList.value,onRefresh:e.getList},null,8,["dialog","currentFrom","selectMenuList","onRefresh"])])}],["__scopeId","data-v-1b79b860"]]);export default O;
