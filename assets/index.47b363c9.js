import{u as e,d as t,a as l,c as a,b as i}from"./role.93a8017d.js";import{_ as s,r as o,o as n,c as d,a as r,w as u,i as p,l as h,k as c,L as m}from"./vendor.85146a32.js";import"./index.2a4ddc7d.js";const g=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"角色名称",overflowTooltip:!0,props:[{prop:"name"}]},{label:"描述",props:[{prop:"description"}]},{label:"用户数",props:[{prop:"adminCount"}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:{activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"操作",minWidth:"100px",props:[{type:"btn",data:[{tip:"分配菜单",type:"primary",icon:"el-icon-more",emit:"occupyOne"},{tip:"分配资源",type:"primary",icon:"el-icon-turn-off",emit:"occupyTwo"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],y={pageNum:1,pageSize:5,keyword:null},f={id:null,name:null,description:null,adminCount:0,status:1},b={data:()=>({config:g,listQuery:Object.assign({},y),list:null,total:null,listLoading:!1,dialogVisible:!1,role:Object.assign({},f),isEdit:!1}),created(){this.getList()},filters:{formatDateTime(e){if(null==e||""===e)return"N/A";let t=new Date(e);return formatDate(t,"yyyy-MM-dd hh:mm:ss")}},methods:{handleResetSearch(){this.listQuery=Object.assign({},y)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.dialogVisible=!0,this.isEdit=!1,this.role=Object.assign({},f)},handleStatusChange(t,l){e(t.id,{status:t.status}).then((e=>{this.$message({type:"success",message:"修改成功!"})})),this.getList()},handleDelete({row:e,index:l}){this.$confirm("是否要删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let l=[];l.push(e.id);let a=new FormData;a.append("ids",l),t(a).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))}))},handleUpdate({row:e,index:t}){this.dialogVisible=!0,this.isEdit=!0,this.role=JSON.parse(JSON.stringify(e)),console.log(this.role)},handleDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.isEdit?l(this.role.id,this.role).then((e=>{this.$message({message:"修改成功！",type:"success"}),this.dialogVisible=!1,this.getList()})):a(this.role).then((e=>{this.$message({message:"添加成功！",type:"success"}),this.dialogVisible=!1,this.getList()}))}))},handleSelectMenu({row:e,index:t}){this.$router.push({path:"/ums/allocMenu",query:{roleId:e.id}})},handleSelectResource({row:e,index:t}){this.$router.push({path:"/ums/allocResource",query:{roleId:e.id}})},getList(){this.listLoading=!0,i(this.listQuery).then((e=>{this.listLoading=!1,this.list=e.data.list,this.total=e.data.total}))}}},w={class:"app-container"},V={class:"operate-container"},S=p("div",null,[p("i",{class:"el-icon-search"}),p("span",null,"筛选搜索")],-1),x=m(" 查询搜索 "),_=m(" 重置 "),C={style:{"margin-top":"15px"}},v={class:"screenForm"},L={class:"operate-container"},O=p("div",null,[p("i",{class:"el-icon-tickets"}),p("span",null,"数据列表")],-1),T=m(" 添加 "),k=m("是"),D=m("否"),Q=m("取 消"),U=m("确 定");var N=s(b,[["render",function(e,t,l,a,i,s){const m=o("el-button"),g=o("el-input"),y=o("el-form-item"),f=o("el-form"),b=o("el-card"),N=o("powerful-table"),$=o("el-radio"),j=o("el-radio-group"),R=o("el-drawer");return n(),d("div",w,[r(b,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:u((()=>[p("div",V,[S,p("div",null,[r(m,{style:{float:"right"},type:"primary",onClick:t[0]||(t[0]=e=>s.getList())},{default:u((()=>[x])),_:1}),r(m,{style:{float:"right","margin-right":"15px"},onClick:t[1]||(t[1]=e=>s.handleResetSearch())},{default:u((()=>[_])),_:1})])]),p("div",C,[r(f,{inline:!0,model:i.listQuery},{default:u((()=>[p("div",v,[r(y,{label:"角色名："},{default:u((()=>[r(g,{modelValue:i.listQuery.keyword,"onUpdate:modelValue":t[2]||(t[2]=e=>i.listQuery.keyword=e),placeholder:"角色名称",clearable:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),r(b,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:u((()=>[p("div",L,[O,p("div",null,[r(m,{type:"primary",class:"btn-add",onClick:t[3]||(t[3]=e=>s.handleAdd()),size:"mini"},{default:u((()=>[T])),_:1})])])])),_:1},8,["shadow"]),r(b,{shadow:e.defaultData.cardShadow},{default:u((()=>[p("div",null,[r(N,{ref:"menuTable",list:i.list,header:i.config,isSelect:!1,total:i.total,tableName:"table",onSizeChange:s.getList,onSwitchChange:s.handleStatusChange,onOccupyOne:s.handleSelectMenu,onOccupyTwo:s.handleSelectResource,onUpdate:s.handleUpdate,onRemove:s.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onOccupyOne","onOccupyTwo","onUpdate","onRemove"])])])),_:1},8,["shadow"]),r(R,{title:i.isEdit?"修改":"添加",modelValue:i.dialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>i.dialogVisible=e),direction:"rtl",ref:"drawer"},{default:u((()=>[r(f,{model:i.role,ref:"roleForm","label-width":"150px"},{default:u((()=>[r(y,{label:"角色名称："},{default:u((()=>[r(g,{modelValue:i.role.name,"onUpdate:modelValue":t[4]||(t[4]=e=>i.role.name=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(y,{label:"描述："},{default:u((()=>[r(g,{modelValue:i.role.description,"onUpdate:modelValue":t[5]||(t[5]=e=>i.role.description=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(y,{label:"是否启用："},{default:u((()=>[i.dialogVisible?(n(),h(j,{key:0,modelValue:i.role.status,"onUpdate:modelValue":t[6]||(t[6]=e=>i.role.status=e)},{default:u((()=>[r($,{label:1},{default:u((()=>[k])),_:1}),r($,{label:0},{default:u((()=>[D])),_:1})])),_:1},8,["modelValue"])):c("",!0)])),_:1}),r(y,null,{default:u((()=>[r(j,{modelValue:i.role.status,"onUpdate:modelValue":t[9]||(t[9]=e=>i.role.status=e)},{default:u((()=>[r(m,{onClick:t[7]||(t[7]=e=>i.dialogVisible=!1)},{default:u((()=>[Q])),_:1}),r(m,{type:"primary",onClick:t[8]||(t[8]=e=>s.handleDialogConfirm())},{default:u((()=>[U])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])}]]);export default N;
