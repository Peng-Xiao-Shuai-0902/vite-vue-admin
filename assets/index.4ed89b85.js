import{u as e,c as t,d as l,a,l as s}from"./resource.4bef7157.js";import{h as r}from"./indexData.2a8cd762.js";import{r as i,o,m as d,w as n,a as u,c,g as m,F as h,k as p,J as g,i as y}from"./vendor.958d76c5.js";import"./index.538feb41.js";const f={props:{dialog:{type:Boolean,default:!1},currentFrom:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},data:()=>({}),emits:["update:currentFrom","update:dialog","refresh"],methods:{close(){this.$emit("update:dialog",!1)},onSubmit(l){this.$refs[l].validate((a=>{if(!a)return this.$message({message:"验证失败",type:"error",duration:1e3}),!1;this.$confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{!!this.currentFrom.id?e(this.currentFrom.id,this.currentFrom).then((e=>{this.$message({message:"修改成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})):t(this.currentFrom).then((e=>{this.$refs[l].resetFields(),this.resetForm(l),this.$message({message:"提交成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})),setTimeout((()=>{this.$emit("refresh")}),200)}))}))},resetForm(e){this.$refs[e].resetFields(),this.$emit("update:currentFrom",{id:null})}}},b=g("提交"),w=g("重置");f.render=function(e,t,l,a,s,r){const g=i("el-input"),y=i("el-form-item"),f=i("el-option"),F=i("el-select"),V=i("el-button"),v=i("el-form"),_=i("el-drawer");return o(),d(_,{title:l.currentFrom.id?"修改":"添加",modelValue:l.dialog,"onUpdate:modelValue":t[6]||(t[6]=e=>l.dialog=e),direction:"rtl",ref:"drawer",onClose:r.close},{default:n((()=>[u(v,{model:l.currentFrom,ref:"From","label-width":"100px",style:{padding:"0 20px"}},{default:n((()=>[u(y,{label:"资源名称："},{default:n((()=>[u(g,{modelValue:l.currentFrom.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.currentFrom.name=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),u(y,{label:"资源路径："},{default:n((()=>[u(g,{modelValue:l.currentFrom.url,"onUpdate:modelValue":t[1]||(t[1]=e=>l.currentFrom.url=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),u(y,{label:"资源分类："},{default:n((()=>[u(F,{modelValue:l.currentFrom.categoryId,"onUpdate:modelValue":t[2]||(t[2]=e=>l.currentFrom.categoryId=e),placeholder:"全部",clearable:"",style:{width:"250px"}},{default:n((()=>[(o(!0),c(h,null,m(l.selectMenuList,(e=>(o(),d(f,{key:e.label,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(y,{label:"描述："},{default:n((()=>[u(g,{modelValue:l.currentFrom.description,"onUpdate:modelValue":t[3]||(t[3]=e=>l.currentFrom.description=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),u(y,null,{default:n((()=>[u(V,{type:"primary",onClick:t[4]||(t[4]=e=>r.onSubmit("From"))},{default:n((()=>[b])),_:1}),l.currentFrom.id?p("",!0):(o(),d(V,{key:0,onClick:t[5]||(t[5]=e=>r.resetForm("From"))},{default:n((()=>[w])),_:1}))])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue","onClose"])};const F={pageNum:1,pageSize:10,nameKeyword:null,urlKeyword:null,categoryId:null},V={id:null,name:null,url:null,categoryId:null,description:""},v={components:{update:f},data:()=>({config:r,listQuery:Object.assign({},F),list:null,total:null,listLoading:!1,isDialog:!1,resource:Object.assign({},V),isEdit:!1,categoryOptions:[],defaultCategoryId:null}),created(){this.getList(),this.getCateList()},methods:{handleResetSearch(){this.listQuery=Object.assign({},F)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.isDialog=!0,this.isEdit=!1,this.resource=Object.assign({},V),this.resource.categoryId=this.defaultCategoryId},handleDelete({row:e,index:t}){l(e.id).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))},handleUpdate({row:e,index:t}){this.isDialog=!0,this.isEdit=!0,this.resource=Object.assign({},e)},handleShowCategory(){console.log(this.$router),this.$router.push({name:"resourceCategory"})},getList(e){this.isDialog=!1,Object.assign(this.listQuery,e||{}),a(this.listQuery).then((e=>{this.list=e.data.list,this.total=e.data.total}))},getCateList(){s().then((e=>{let t=e.data;for(let l=0;l<t.length;l++){let e=t[l];this.categoryOptions.push({label:e.name,value:e.id})}this.defaultCategoryId=t[0].id}))}}},_={class:"app-container"},C={class:"operate-container"},x=y("div",null,[y("i",{class:"el-icon-search"}),y("span",null,"筛选搜索")],-1),L=g(" 查询搜索 "),S=g(" 重置 "),Q={style:{"margin-top":"15px"}},$={class:"screenForm"},U={class:"operate-container"},D=y("div",null,[y("i",{class:"el-icon-tickets"}),y("span",null,"数据列表")],-1),j=g(" 添加 "),k=g(" 资源分类 ");v.render=function(e,t,l,a,s,r){const p=i("el-button"),g=i("el-input"),f=i("el-form-item"),b=i("el-option"),w=i("el-select"),F=i("el-form"),V=i("el-card"),v=i("powerful-table"),O=i("update");return o(),c("div",_,[u(V,{style:{marginBottom:"20px"},class:"filter-container",shadow:e.defaultData.cardShadow},{default:n((()=>[y("div",C,[x,y("div",null,[u(p,{style:{float:"right"},type:"primary",onClick:t[0]||(t[0]=e=>r.getList())},{default:n((()=>[L])),_:1}),u(p,{style:{float:"right","margin-right":"15px"},onClick:t[1]||(t[1]=e=>r.handleResetSearch())},{default:n((()=>[S])),_:1})])]),y("div",Q,[u(F,{inline:!0,model:s.listQuery},{default:n((()=>[y("div",$,[u(f,{label:"资源名称："},{default:n((()=>[u(g,{modelValue:s.listQuery.nameKeyword,"onUpdate:modelValue":t[2]||(t[2]=e=>s.listQuery.nameKeyword=e),class:"input-width",placeholder:"资源名称",clearable:""},null,8,["modelValue"])])),_:1}),u(f,{label:"资源路径："},{default:n((()=>[u(g,{modelValue:s.listQuery.urlKeyword,"onUpdate:modelValue":t[3]||(t[3]=e=>s.listQuery.urlKeyword=e),class:"input-width",placeholder:"资源路径",clearable:""},null,8,["modelValue"])])),_:1}),u(f,{label:"资源分类："},{default:n((()=>[u(w,{modelValue:s.listQuery.categoryId,"onUpdate:modelValue":t[4]||(t[4]=e=>s.listQuery.categoryId=e),placeholder:"全部",clearable:"",class:"input-width"},{default:n((()=>[(o(!0),c(h,null,m(s.categoryOptions,(e=>(o(),d(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),u(V,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:n((()=>[y("div",U,[D,y("div",null,[u(p,{type:"primary",class:"btn-add",onClick:t[5]||(t[5]=e=>r.handleAdd()),size:"mini"},{default:n((()=>[j])),_:1}),u(p,{size:"mini",class:"btn-add",onClick:t[6]||(t[6]=e=>r.handleShowCategory())},{default:n((()=>[k])),_:1})])])])),_:1},8,["shadow"]),u(V,{shadow:e.defaultData.cardShadow},{default:n((()=>[y("div",null,[u(v,{ref:"menuTable",list:s.list,header:s.config,isSelect:!1,total:s.total,tableName:"menuTable",onSizeChange:r.getList,onUpdate:r.handleUpdate,onRemove:r.handleDelete},null,8,["list","header","total","onSizeChange","onUpdate","onRemove"])])])),_:1},8,["shadow"]),u(O,{dialog:s.isDialog,"onUpdate:dialog":t[7]||(t[7]=e=>s.isDialog=e),currentFrom:s.resource,"onUpdate:currentFrom":t[8]||(t[8]=e=>s.resource=e),selectMenuList:s.categoryOptions,onRefresh:r.getList},null,8,["dialog","currentFrom","selectMenuList","onRefresh"])])};export default v;
