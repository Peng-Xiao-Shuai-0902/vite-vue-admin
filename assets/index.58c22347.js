import{s as D}from"./index.dadbea57.js";import{_ as I,r as i,o as y,l as V,w as a,a as l,c as U,g as x,F as R,k as L,I as v,d as $,e as z,u as j,G as g,y as E,i as p,p as q,m as O,v as Q,q as H,s as J,D as P}from"./vendor.8c3eb18c.js";import{i as W}from"./index.91992112.js";function G(e,t){return D({url:"menu/list?parentId="+e,params:t})}function K(e){return D({url:"menu/remove",method:"delete",data:{ids:e}})}function M(e){return D({url:"menu/update",method:"post",data:e})}const X=[{label:"\u7F16\u53F7",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"\u83DC\u5355\u540D\u79F0",overflowTooltip:!0,props:[{prop:"title"}]},{label:"\u83DC\u5355\u7EA7\u6570",props:[{prop:"level",filter:[{key:0,value:"\u4E00\u7EA7"},{key:1,value:"\u4E8C\u7EA7"}]}]},{label:"\u524D\u7AEF\u540D\u79F0",props:[{prop:"name"}]},{label:"\u524D\u7AEF\u56FE\u6807",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"\u662F\u5426\u663E\u793A",props:[{prop:"hidden",type:"switch",data:{activeValue:1,inactiveValue:0,activeColor:"store.getter.themeColo",inactiveText:"\u9690",activeText:"\u663E"}}]},{label:"\u6392\u5E8F",sortable:!0,props:[{prop:"sort"}]},{label:"\u64CD\u4F5C",minWidth:"180px",props:[{type:"btn",data:[{tip:"\u67E5\u770B\u4E0B\u7EA7",type:"primary",icon:"el-icon-view",emit:"query"},{tip:"\u7F16\u8F91",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"\u5220\u9664",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],Y={name:"MenuDetail",components:{iconSelect:W},props:{dialog:{type:Boolean,default:!1},currentFrom:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},data(){return{rules:{title:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u540D\u79F0",trigger:"blur"},{min:2,max:140,message:"\u957F\u5EA6\u5728 2 \u5230 140 \u4E2A\u5B57\u7B26",trigger:"blur"}],name:[{required:!0,message:"\u8BF7\u8F93\u5165\u524D\u7AEF\u540D\u79F0",trigger:"blur"},{min:2,max:140,message:"\u957F\u5EA6\u5728 2 \u5230 140 \u4E2A\u5B57\u7B26",trigger:"blur"}],icon:[{required:!0,message:"\u8BF7\u8F93\u5165\u524D\u7AEF\u56FE\u6807",trigger:"blur"},{min:2,max:140,message:"\u957F\u5EA6\u5728 2 \u5230 140 \u4E2A\u5B57\u7B26",trigger:"blur"}]}}},emits:["update:currentFrom","update:dialog","refresh"],methods:{close(){this.$emit("update:dialog",!1),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})},onSubmit(e){this.$refs[e].validate(t=>{if(t)this.$confirm("\u662F\u5426\u63D0\u4EA4\u6570\u636E","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{M(this.currentFrom).then(n=>{this.$message({message:"\u4FEE\u6539\u6210\u529F",type:"success",duration:1e3}),this.$emit("update:dialog",!1)}),setTimeout(()=>{this.$emit("refresh")},300)});else return this.$message({message:"\u9A8C\u8BC1\u5931\u8D25",type:"error",duration:1e3}),!1})},resetForm(e){this.$refs[e].resetFields(),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})}}},Z=v("\u662F"),ee=v("\u5426"),te=v("\u63D0\u4EA4"),ne=v("\u91CD\u7F6E");function le(e,t,n,C,h,_){const c=i("el-input"),r=i("el-form-item"),m=i("el-option"),u=i("el-select"),d=i("icon-select"),b=i("el-radio"),w=i("el-radio-group"),f=i("el-button"),S=i("el-form"),k=i("el-drawer");return y(),V(k,{title:n.currentFrom.id?"\u4FEE\u6539":"\u6DFB\u52A0",modelValue:n.dialog,"onUpdate:modelValue":t[8]||(t[8]=o=>n.dialog=o),direction:"rtl",ref:"drawer",onClose:_.close},{default:a(()=>[l(S,{model:n.currentFrom,rules:h.rules,ref:"menuFrom","label-width":"100px",style:{padding:"0 20px"}},{default:a(()=>[l(r,{label:"\u83DC\u5355\u540D\u79F0\uFF1A",prop:"title"},{default:a(()=>[l(c,{modelValue:n.currentFrom.title,"onUpdate:modelValue":t[0]||(t[0]=o=>n.currentFrom.title=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"\u4E0A\u7EA7\u83DC\u5355\uFF1A"},{default:a(()=>[l(u,{modelValue:n.currentFrom.parentId,"onUpdate:modelValue":t[1]||(t[1]=o=>n.currentFrom.parentId=o),style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u83DC\u5355"},{default:a(()=>[(y(!0),U(R,null,x(n.selectMenuList,o=>(y(),V(m,{key:o.id,label:o.title,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"\u524D\u7AEF\u540D\u79F0\uFF1A",prop:"name"},{default:a(()=>[l(c,{modelValue:n.currentFrom.name,"onUpdate:modelValue":t[2]||(t[2]=o=>n.currentFrom.name=o)},null,8,["modelValue"])]),_:1}),l(r,{label:"\u524D\u7AEF\u56FE\u6807\uFF1A",prop:"icon"},{default:a(()=>[l(d,{icon:n.currentFrom.icon,"onUpdate:icon":t[3]||(t[3]=o=>n.currentFrom.icon=o)},null,8,["icon"])]),_:1}),l(r,{label:"\u662F\u5426\u663E\u793A\uFF1A"},{default:a(()=>[n.dialog?(y(),V(w,{key:0,modelValue:n.currentFrom.hidden,"onUpdate:modelValue":t[4]||(t[4]=o=>n.currentFrom.hidden=o)},{default:a(()=>[l(b,{label:0},{default:a(()=>[Z]),_:1}),l(b,{label:1},{default:a(()=>[ee]),_:1})]),_:1},8,["modelValue"])):L("",!0)]),_:1}),l(r,{label:"\u6392\u5E8F\uFF1A"},{default:a(()=>[l(c,{modelValue:n.currentFrom.sort,"onUpdate:modelValue":t[5]||(t[5]=o=>n.currentFrom.sort=o)},null,8,["modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(f,{type:"primary",onClick:t[6]||(t[6]=o=>_.onSubmit("menuFrom"))},{default:a(()=>[te]),_:1}),n.currentFrom.id?L("",!0):(y(),V(f,{key:0,onClick:t[7]||(t[7]=o=>_.resetForm("menuFrom"))},{default:a(()=>[ne]),_:1}))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue","onClose"])}var oe=I(Y,[["render",le]]);const A=[{id:0,title:"\u65E0\u4E0A\u7EA7\u83DC\u5355"}],ae=$({components:{update:oe},setup(){const{proxy:e}=P(),t=z(),n=j();let C=g({value:[]}),h=g({value:[]}),_=E(0),c=g(X),r=g({pageNum:1,pageSize:10}),m=E(0),u=g({value:[]}),d=E(!1),b=g({value:{}});f();function w(){d.value=!0,b.value={parentId:m.value,hidden:0,sort:0}}function f(s){m.value==0&&(u.value=[A],h.value=A),Object.assign(r,s||r),G(m.value,r).then(F=>{C.value=g(F.data.list),_.value=F.data.total})}function S(s){M(s).then(F=>{e.$message({message:"\u4FEE\u6539\u6210\u529F",type:"success",duration:1e3})})}function k({row:s,index:F}){u.value.push([s]),h.value=u.value[u.value.length-1],m.value=s.id,f()}function o(){r.pageNum=1,m.value=u.value[u.value.length-1][0].parentId,h.value=u.value[u.value.length-1],u.value.splice(u.value.length-1,1),f()}function B({row:s,index:F}){d.value=!0,b.value=g(JSON.parse(JSON.stringify(s)))}function T({row:s,index:F}){K([s.id]).then(he=>{e.$message({message:"\u5220\u9664\u6210\u529F",type:"success",duration:1e3}),f()})}return{list:C,total:_,config:c,listQuery:r,parentId:m,upParent:u,isDialog:d,currentFrom:b,allList:h,handleAddMenu:w,getList:f,backUp:o,handleHiddenChange:S,handleShowNextLevel:k,handleUpdate:B,handleDelete:T,refreshMenu:()=>{t.getRoutes().forEach(s=>{s.meta&&s.meta.id&&t.removeRoute(s.name)}),n.dispatch("userInfo")}}}}),N=e=>(H("data-v-6704ffe0"),e=e(),J(),e),re={class:"app-container"},ue={class:"tipBox warning",style:{"margin-top":"0"}},se=v("\u4FEE\u6539\u3001\u5220\u9664 \u83DC\u5355\u5E76\u4E0D\u4F1A\u76F4\u63A5\u6539\u53D8\u4FA7\u8FB9\u680F\u3002\u9700\u8981\u91CD\u65B0\u8C03\u7528\u63A5\u53E3\u3002"),ie=v(" \u5237\u65B0\u4FA7\u8FB9\u680F"),de={class:"operate-container"},me=N(()=>p("div",null,[p("i",{class:"el-icon-tickets"}),p("span",null,"\u6570\u636E\u5217\u8868")],-1)),pe=N(()=>p("i",{class:"el-icon-back"},null,-1)),ce=v("\u8FD4\u56DE\u4E0A\u7EA7 "),fe=v(" \u6DFB\u52A0 ");function ve(e,t,n,C,h,_){const c=i("el-button"),r=i("powerful-table"),m=i("el-card"),u=i("update");return y(),U("div",re,[l(m,{shadow:e.defaultData.cardShadow},{default:a(()=>[p("div",ue,[p("p",null,[se,p("span",{class:"active",onClick:t[0]||(t[0]=(...d)=>e.refreshMenu&&e.refreshMenu(...d))},"\u70B9\u51FB"),ie])]),p("div",de,[me,p("div",null,[l(q,{name:"fadeOpticy"},{default:a(()=>[O(l(c,{type:"primary",class:"btn-add",onClick:t[1]||(t[1]=d=>e.backUp()),size:"mini"},{default:a(()=>[pe,ce]),_:1},512),[[Q,e.upParent.value.length>1]])]),_:1}),l(c,{type:"primary",class:"btn-add",onClick:t[2]||(t[2]=d=>e.handleAddMenu()),size:"mini"},{default:a(()=>[fe]),_:1})])]),p("div",null,[l(r,{ref:"menuTable",list:e.list.value,header:e.config,isSelect:!1,total:e.total,tableName:"menuTable",onSizeChange:e.getList,onSwitchChange:e.handleHiddenChange,onQuery:e.handleShowNextLevel,onUpdate:e.handleUpdate,onRemove:e.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onQuery","onUpdate","onRemove"])])]),_:1},8,["shadow"]),l(u,{dialog:e.isDialog,"onUpdate:dialog":t[3]||(t[3]=d=>e.isDialog=d),currentFrom:e.currentFrom.value,"onUpdate:currentFrom":t[4]||(t[4]=d=>e.currentFrom.value=d),selectMenuList:e.allList.value,onRefresh:e.getList},null,8,["dialog","currentFrom","selectMenuList","onRefresh"])])}var ye=I(ae,[["render",ve],["__scopeId","data-v-6704ffe0"]]);export{ye as default};
