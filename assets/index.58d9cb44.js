import{s as e,b as l,u as a}from"./index.41a3e251.js";import{C as t,d as o,u as s,G as r,y as i,r as d,o as u,c as n,a as p,w as c,i as m,M as f,F as y,g as h,l as v,I as b,t as g,E as w}from"./vendor.d1cffd1a.js";const _=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"帐号",overflowTooltip:!0,props:[{prop:"username"}]},{label:"角色",props:[{type:"slot",slotName:"roles"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:{beforeFunction:e=>(t.warning("不允许停用！"),1!=e.id)}}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",data:[{tip:"分配角色",type:"primary",icon:"el-icon-user",emit:"occupyOne"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove",showBtn:e=>1!=e.id}]}]}],S={class:"app-container"},V={class:"operate-container"},k=m("div",null,[m("i",{class:"el-icon-search"}),m("span",null,"筛选搜索")],-1),x=b(" 查询搜索 "),C=b(" 重置 "),N={style:{"margin-top":"15px"}},O={class:"screenForm"},Q=m("div",{class:"operate-container"},[m("div",null,[m("i",{class:"el-icon-tickets"}),m("span",null,"数据列表")])],-1),z=b("取 消"),T=b("确 定"),j=o({setup(t){const o=s(),{proxy:j}=w(),F=r({role:!1,edit:!1}),U=i({}),B=r({list:[],header:_,total:0,listQuery:{pageNum:1,pageSize:10,username:""}}),D=i([]),E=()=>{l(B.listQuery).then((e=>{B.list=e.data.list,B.total=e.data.total}))};var I;(I={pageNum:1,pageSize:100},e({url:"admin/roleList",params:I})).then((e=>{D.value=e.data.list})),E();const J=({row:e})=>{a({ids:[e.id]}).then((e=>{j.$message.success("删除成功！"),E()}))},W=e=>{o.state.user.userInfo.id==e.id&&0===e.status&&j.$message.error("你的账号已被停用！")};return(e,l)=>{const a=d("el-button"),t=d("el-input"),o=d("el-form-item"),s=d("el-form"),r=d("el-card"),i=d("el-tag"),w=d("powerful-table"),_=d("el-option"),j=d("el-select"),I=d("el-dialog");return u(),n("div",S,[p(r,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:c((()=>[m("div",V,[k,m("div",null,[p(a,{style:{float:"right"},type:"primary",onClick:l[0]||(l[0]=e=>E())},{default:c((()=>[x])),_:1}),p(a,{style:{float:"right","margin-right":"15px"},onClick:l[1]||(l[1]=e=>{Object.keys(B.listQuery).forEach((e=>{-1==["pageNum","pageSize"].indexOf(e)&&(B.listQuery[e]="")}))})},{default:c((()=>[C])),_:1})])]),m("div",N,[p(s,{inline:!0,model:f(B).listQuery},{default:c((()=>[m("div",O,[p(o,{label:"名称："},{default:c((()=>[p(t,{modelValue:f(B).listQuery.username,"onUpdate:modelValue":l[2]||(l[2]=e=>f(B).listQuery.username=e),placeholder:"请输入账号名",style:{width:"80%"},clearable:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),p(r,{shadow:e.defaultData.cardShadow},{default:c((()=>[Q,m("div",null,[p(w,{ref:(e,l)=>{l.menuTable=e},list:f(B).list,header:f(B).header,isSelect:!1,total:f(B).total,tableName:"menuTable",onSizeChange:E,onSwitchChange:W,onOccupyOne:l[3]||(l[3]=({row:e})=>{f(F).role=!0,U.value=JSON.parse(JSON.stringify(e))}),onRemove:J},{roles:c((({row:e})=>[(u(!0),n(y,null,h(e.roles,(e=>(u(),v(i,{key:e},{default:c((()=>{var l;return[b(g(null==(l=D.value.filter((l=>l.value==e))[0])?void 0:l.label),1)]})),_:2},1024)))),128))])),_:1},8,["list","header","total"])])])),_:1},8,["shadow"]),p(I,{title:"分配角色",modelValue:f(F).role,"onUpdate:modelValue":l[7]||(l[7]=e=>f(F).role=e),width:"30%"},{footer:c((()=>[p(a,{onClick:l[5]||(l[5]=e=>f(F).role=!1)},{default:c((()=>[z])),_:1}),p(a,{type:"primary",onClick:l[6]||(l[6]=e=>(F.role=!1,void(B.list=B.list.map((e=>(e.id==U.value.id&&(e=U.value),e))))))},{default:c((()=>[T])),_:1})])),default:c((()=>[p(j,{modelValue:U.value.roles,"onUpdate:modelValue":l[4]||(l[4]=e=>U.value.roles=e),multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:c((()=>[(u(!0),n(y,null,h(D.value,(e=>(u(),v(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])}}});export default j;
