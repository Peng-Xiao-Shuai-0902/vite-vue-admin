import{u as e,b as l,c as a,e as t,f as i,h as s,i as o}from"./index.de99b198.js";import{f as d}from"./role.445b1330.js";import{_ as n,r as u,o as m,c as r,a as h,w as p,i as c,l as g,k as f,F as y,g as b,L as V}from"./vendor.28d90a97.js";const w=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"帐号",overflowTooltip:!0,props:[{prop:"username"}]},{label:"姓名",props:[{prop:"nickName"}]},{label:"邮箱",props:[{prop:"email"}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"最后登录",props:[{prop:"loginTime"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:{activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"操作",minWidth:"180px",props:[{type:"btn",data:[{tip:"分配角色",type:"primary",icon:"el-icon-user",emit:"occupyOne"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],_={pageNum:1,pageSize:10,keyword:null},x={id:null,username:null,password:null,nickName:null,email:null,note:null,status:1},L={data:()=>({config:w,listQuery:Object.assign({},_),list:null,total:null,listLoading:!1,dialogVisible:!1,admin:Object.assign({},x),isEdit:!1,allocDialogVisible:!1,allocRoleIds:[],allRoleList:[],allocAdminId:null}),created(){this.getList(),this.getAllRoleList()},filters:{formatDateTime(e){if(null==e||""===e)return"N/A";let l=new Date(e);return formatDate(l,"yyyy-MM-dd hh:mm:ss")}},methods:{handleResetSearch(){this.listQuery=Object.assign({},_)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.dialogVisible=!0,this.isEdit=!1,this.admin=Object.assign({},x)},handleStatusChange(l,a){e(l.id,{status:l.status}).then((e=>{this.$message({type:"success",message:"修改成功!"}),this.getList()}))},handleDelete({row:e,index:a}){l(e.id).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))},handleUpdate({row:e,index:l}){this.dialogVisible=!0,this.isEdit=!0,this.admin=Object.assign({},e)},handleDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.isEdit?a(this.admin.id,this.admin).then((e=>{this.$message({message:"修改成功！",type:"success"}),this.dialogVisible=!1,this.getList()})):t(this.admin).then((e=>{this.$message({message:"添加成功！",type:"success"}),this.dialogVisible=!1,this.getList()}))}))},handleAllocDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=new FormData;e.append("adminId",this.allocAdminId),e.append("roleIds",this.allocRoleIds),i(e).then((e=>{this.$message({message:"分配成功！",type:"success"}),this.allocDialogVisible=!1}))}))},handleSelectRole({row:e,index:l}){this.allocAdminId=e.id,this.allocDialogVisible=!0,this.getRoleListByAdmin(e.id)},getList(){this.listLoading=!0,s(this.listQuery).then((e=>{this.listLoading=!1,this.list=e.data.list,this.total=e.data.total}))},getAllRoleList(){d().then((e=>{this.allRoleList=e.data}))},getRoleListByAdmin(e){o(e).then((e=>{let l=e.data;if(this.allocRoleIds=[],null!=l&&l.length>0)for(let a=0;a<l.length;a++)this.allocRoleIds.push(l[a].id)}))}}},C={class:"app-container"},v={class:"operate-container"},D=c("div",null,[c("i",{class:"el-icon-search"}),c("span",null,"筛选搜索")],-1),R=V(" 查询搜索 "),k=V(" 重置 "),S={style:{"margin-top":"15px"}},U={class:"screenForm"},A={class:"operate-container"},T=c("div",null,[c("i",{class:"el-icon-tickets"}),c("span",null,"数据列表")],-1),I=V(" 添加 "),N=V("是"),O=V("否"),Q=V("取 消"),j=V("确 定"),B=V("取 消"),$=V("确 定");var z=n(L,[["render",function(e,l,a,t,i,s){const o=u("el-button"),d=u("el-input"),n=u("el-form-item"),V=u("el-form"),w=u("el-card"),_=u("powerful-table"),x=u("el-radio"),L=u("el-radio-group"),z=u("el-dialog"),E=u("el-option"),F=u("el-select");return m(),r("div",C,[h(w,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:p((()=>[c("div",v,[D,c("div",null,[h(o,{style:{float:"right"},type:"primary",onClick:l[0]||(l[0]=e=>s.getList())},{default:p((()=>[R])),_:1}),h(o,{style:{float:"right","margin-right":"15px"},onClick:l[1]||(l[1]=e=>s.handleResetSearch())},{default:p((()=>[k])),_:1})])]),c("div",S,[h(V,{inline:!0,model:i.listQuery},{default:p((()=>[c("div",U,[h(n,{label:"输入搜索："},{default:p((()=>[h(d,{modelValue:i.listQuery.keyword,"onUpdate:modelValue":l[2]||(l[2]=e=>i.listQuery.keyword=e),class:"input-width",placeholder:"帐号/姓名",clearable:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),h(w,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:p((()=>[c("div",A,[T,c("div",null,[h(o,{type:"primary",class:"btn-add",onClick:l[3]||(l[3]=e=>s.handleAdd()),size:"mini"},{default:p((()=>[I])),_:1})])])])),_:1},8,["shadow"]),h(w,{shadow:e.defaultData.cardShadow},{default:p((()=>[c("div",null,[h(_,{ref:"menuTable",list:i.list,header:i.config,isSelect:!1,total:i.total,tableName:"menuTable",onSizeChange:s.getList,onSwitchChange:s.handleStatusChange,onOccupyOne:s.handleSelectRole,onUpdate:s.handleUpdate,onRemove:s.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onOccupyOne","onUpdate","onRemove"])])])),_:1},8,["shadow"]),h(z,{title:i.isEdit?"编辑用户":"添加用户",modelValue:i.dialogVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>i.dialogVisible=e),width:"40%"},{default:p((()=>[h(V,{model:i.admin,ref:"adminForm","label-width":"150px"},{default:p((()=>[h(n,{label:"帐号："},{default:p((()=>[h(d,{modelValue:i.admin.username,"onUpdate:modelValue":l[4]||(l[4]=e=>i.admin.username=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),h(n,{label:"姓名："},{default:p((()=>[h(d,{modelValue:i.admin.nickName,"onUpdate:modelValue":l[5]||(l[5]=e=>i.admin.nickName=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),h(n,{label:"邮箱："},{default:p((()=>[h(d,{modelValue:i.admin.email,"onUpdate:modelValue":l[6]||(l[6]=e=>i.admin.email=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),h(n,{label:"密码："},{default:p((()=>[h(d,{modelValue:i.admin.password,"onUpdate:modelValue":l[7]||(l[7]=e=>i.admin.password=e),type:"password",style:{width:"250px"}},null,8,["modelValue"])])),_:1}),h(n,{label:"备注："},{default:p((()=>[h(d,{modelValue:i.admin.note,"onUpdate:modelValue":l[8]||(l[8]=e=>i.admin.note=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),h(n,{label:"是否启用："},{default:p((()=>[i.dialogVisible?(m(),g(L,{key:0,modelValue:i.admin.status,"onUpdate:modelValue":l[9]||(l[9]=e=>i.admin.status=e)},{default:p((()=>[h(x,{label:1},{default:p((()=>[N])),_:1}),h(x,{label:0},{default:p((()=>[O])),_:1})])),_:1},8,["modelValue"])):f("",!0)])),_:1}),h(n,null,{default:p((()=>[h(o,{onClick:l[10]||(l[10]=e=>i.dialogVisible=!1)},{default:p((()=>[Q])),_:1}),h(o,{type:"primary",onClick:l[11]||(l[11]=e=>s.handleDialogConfirm())},{default:p((()=>[j])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),h(z,{title:"分配角色",modelValue:i.allocDialogVisible,"onUpdate:modelValue":l[16]||(l[16]=e=>i.allocDialogVisible=e),width:"30%"},{footer:p((()=>[h(o,{onClick:l[14]||(l[14]=e=>i.allocDialogVisible=!1)},{default:p((()=>[B])),_:1}),h(o,{type:"primary",onClick:l[15]||(l[15]=e=>s.handleAllocDialogConfirm())},{default:p((()=>[$])),_:1})])),default:p((()=>[h(F,{modelValue:i.allocRoleIds,"onUpdate:modelValue":l[13]||(l[13]=e=>i.allocRoleIds=e),multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:p((()=>[(m(!0),r(y,null,b(i.allRoleList,(e=>(m(),g(E,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])}]]);export default z;
