import{u as e,c as t,a,b as l,d as o}from"./menu.2a44b017.js";import{q as r,v as n,r as i,o as s,c as u,a as d,F as m,k as c,m as p,A as h,G as g,f,X as v,e as b,g as y,z as F,x as _,y as w}from"./vendor.d2840fd2.js";import{a as x,b as V}from"./index.d80dab01.js";const S=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"菜单名称",overflowTooltip:!0,props:[{prop:"title"}]},{label:"菜单级数",props:[{prop:"level",filter:[{key:0,value:"一级"},{key:1,value:"二级"}]}]},{label:"前端名称",props:[{prop:"name"}]},{label:"前端图标",props:[{type:"iconfont",prop:"icon",data:{style:{fontSize:"24px"},class:["viteIcon"]}}]},{label:"是否显示",props:[{prop:"hidden",type:"switch",data:{activeValue:0,inactiveValue:1,activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"排序",sortable:!0,props:[{prop:"sort"}]},{label:"操作",minWidth:"180px",props:[{type:"btn",data:[{tip:"查看下级",type:"primary",icon:"el-icon-view",emit:"query"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}];const U={name:"MenuDetail",props:{dialog:{type:Boolean,default:!1},currentFrom:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},data:()=>({rules:{title:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],name:[{required:!0,message:"请输入前端名称",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}],icon:[{required:!0,message:"请输入前端图标",trigger:"blur"},{min:2,max:140,message:"长度在 2 到 140 个字符",trigger:"blur"}]}}),emits:["update:currentFrom","update:dialog","refresh"],methods:{close(){this.$emit("update:dialog",!1),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})},onSubmit(a){this.$refs[a].validate((l=>{if(!l)return this.$message({message:"验证失败",type:"error",duration:1e3}),!1;this.$confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.currentFrom.id?e(this.currentFrom.id,this.currentFrom).then((e=>{this.$message({message:"修改成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})):t(this.currentFrom).then((e=>{this.$refs[a].resetFields(),this.resetForm(a),this.$message({message:"提交成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})),setTimeout((()=>{this.$emit("refresh")}),300)}))}))},resetForm(e){this.$refs[e].resetFields(),this.$emit("update:currentFrom",{parentId:0,hidden:0,sort:0})}}},$=h();r("data-v-3dacf8ae");const k=g("是"),C=g("否"),L=g("提交"),I=g("重置");n();const D=$(((e,t,a,l,o,r)=>{const n=i("el-input"),h=i("el-form-item"),g=i("el-option"),f=i("el-select"),v=i("el-radio"),b=i("el-radio-group"),y=i("el-button"),F=i("el-form"),_=i("el-drawer");return s(),u(_,{title:a.currentFrom.id?"修改":"添加",modelValue:a.dialog,"onUpdate:modelValue":t[9]||(t[9]=e=>a.dialog=e),direction:"rtl",ref:"drawer",onClose:r.close},{default:$((()=>[d(F,{model:a.currentFrom,rules:o.rules,ref:"menuFrom","label-width":"100px",style:{padding:"0 20px"}},{default:$((()=>[d(h,{label:"菜单名称：",prop:"title"},{default:$((()=>[d(n,{modelValue:a.currentFrom.title,"onUpdate:modelValue":t[1]||(t[1]=e=>a.currentFrom.title=e)},null,8,["modelValue"])])),_:1}),d(h,{label:"上级菜单："},{default:$((()=>[d(f,{modelValue:a.currentFrom.parentId,"onUpdate:modelValue":t[2]||(t[2]=e=>a.currentFrom.parentId=e),style:{width:"100%"},placeholder:"请选择菜单"},{default:$((()=>[(s(!0),u(m,null,c(a.selectMenuList,(e=>(s(),u(g,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(h,{label:"前端名称：",prop:"name"},{default:$((()=>[d(n,{modelValue:a.currentFrom.name,"onUpdate:modelValue":t[3]||(t[3]=e=>a.currentFrom.name=e)},null,8,["modelValue"])])),_:1}),d(h,{label:"前端图标：",prop:"icon"},{default:$((()=>[d(n,{modelValue:a.currentFrom.icon,"onUpdate:modelValue":t[4]||(t[4]=e=>a.currentFrom.icon=e),style:{width:"80%"}},null,8,["modelValue"]),d("i",{class:[a.currentFrom.icon,e.defalutData.iconfont],style:{"margin-left":"10px","font-size":"24px"}},null,2)])),_:1}),d(h,{label:"是否显示："},{default:$((()=>[a.dialog?(s(),u(b,{key:0,modelValue:a.currentFrom.hidden,"onUpdate:modelValue":t[5]||(t[5]=e=>a.currentFrom.hidden=e)},{default:$((()=>[d(v,{label:0},{default:$((()=>[k])),_:1}),d(v,{label:1},{default:$((()=>[C])),_:1})])),_:1},8,["modelValue"])):p("",!0)])),_:1}),d(h,{label:"排序："},{default:$((()=>[d(n,{modelValue:a.currentFrom.sort,"onUpdate:modelValue":t[6]||(t[6]=e=>a.currentFrom.sort=e)},null,8,["modelValue"])])),_:1}),d(h,null,{default:$((()=>[d(y,{type:"primary",onClick:t[7]||(t[7]=e=>r.onSubmit("menuFrom"))},{default:$((()=>[L])),_:1}),a.currentFrom.id?p("",!0):(s(),u(y,{key:0,onClick:t[8]||(t[8]=e=>r.resetForm("menuFrom"))},{default:$((()=>[I])),_:1}))])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue","onClose"])}));U.render=D,U.__scopeId="data-v-3dacf8ae";const z=[{id:0,title:"无上级菜单"}],T=f({components:{update:U},setup(){const e=v().ctx;x(),V();let t=b({value:[]}),r=b({value:[]});console.log(r.value);let n=y(0),i=b(S),s=b({pageNum:1,pageSize:10}),u=y(0),d=b({value:[]}),m=y(!1),c=b({value:{}});function p(e){0==u.value&&(d.value=[z],r.value=z,console.log(123,d)),Object.assign(s,e||s),a(u.value,s).then((e=>{t.value=b(e.data.list),n.value=e.data.total}))}return p(),{list:t,total:n,config:i,listQuery:s,parentId:u,upParent:d,isDialog:m,currentFrom:c,allList:r,handleAddMenu:function(){m.value=!0,c.value={parentId:u.value,hidden:0,sort:0},console.log("添加",c)},getList:p,backUp:function(){s.pageNum=1,u.value=d.value[d.value.length-1][0].parentId,r.value=d.value[d.value.length-1],d.value.splice(d.value.length-1,1),p()},handleHiddenChange:function(t,a){l(t.id,{hidden:t.hidden}).then((t=>{e.$message({message:"修改成功",type:"success",duration:1e3})}))},handleShowNextLevel:function({row:e,index:t}){console.log(d.value),d.value.push([e]),r.value=d.value[d.value.length-1],u.value=e.id,p()},handleUpdate:function({row:e,index:t}){m.value=!0,c.value=b(JSON.parse(JSON.stringify(e)))},handleDelete:function({row:t,index:a}){o(t.id).then((t=>{e.$message({message:"删除成功",type:"success",duration:1e3}),p()}))}}}}),M=h();r("data-v-54412f2b");const N={class:"app-container"},j={class:"operate-container"},q=d("div",null,[d("i",{class:"el-icon-tickets"}),d("span",null,"数据列表")],-1),O=d("i",{class:"el-icon-back"},null,-1),A=g("返回上级 "),B=g(" 添加 ");n();const R=M(((e,t,a,l,o,r)=>{const n=i("el-button"),m=i("el-card"),c=i("powerful-table"),p=i("update");return s(),u("div",N,[d(m,{style:{marginBottom:"20px"},shadow:e.defalutData.cardShadow},{default:M((()=>[d("div",j,[q,d("div",null,[d(F,{name:"fadeOpticy"},{default:M((()=>[_(d(n,{type:"primary",class:"btn-add",onClick:t[1]||(t[1]=t=>e.backUp()),size:"mini"},{default:M((()=>[O,A])),_:1},512),[[w,e.upParent.value.length>1]])])),_:1}),d(n,{type:"primary",class:"btn-add",onClick:t[2]||(t[2]=t=>e.handleAddMenu()),size:"mini"},{default:M((()=>[B])),_:1})])])])),_:1},8,["shadow"]),d(m,{shadow:e.defalutData.cardShadow},{default:M((()=>[d("div",null,[d(c,{ref:"menuTable",list:e.list.value,header:e.config,isSelect:!1,total:e.total,tableName:"menuTable",onSizeChange:e.getList,onSwitchChange:e.handleHiddenChange,onQuery:e.handleShowNextLevel,onUpdate:e.handleUpdate,onRemove:e.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onQuery","onUpdate","onRemove"])])])),_:1},8,["shadow"]),d(p,{dialog:e.isDialog,"onUpdate:dialog":t[3]||(t[3]=t=>e.isDialog=t),currentFrom:e.currentFrom.value,"onUpdate:currentFrom":t[4]||(t[4]=t=>e.currentFrom.value=t),selectMenuList:e.allList.value,onRefresh:e.getList},null,8,["dialog","currentFrom","selectMenuList","onRefresh"])])}));T.render=R,T.__scopeId="data-v-54412f2b";export default T;
