import{u as e,d as t,a as l,c as a,b as i}from"./role.1111338c.js";import{r as s,o,c as n,a as d,w as r,i as u,m as p,k as h,K as c}from"./vendor.45a16529.js";import"./index.bb460d95.js";const m=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"角色名称",overflowTooltip:!0,props:[{prop:"name"}]},{label:"描述",props:[{prop:"description"}]},{label:"用户数",props:[{prop:"adminCount"}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:{activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"操作",minWidth:"100px",props:[{type:"btn",data:[{tip:"分配菜单",type:"primary",icon:"el-icon-more",emit:"occupyOne"},{tip:"分配资源",type:"primary",icon:"el-icon-turn-off",emit:"occupyTwo"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],g={pageNum:1,pageSize:5,keyword:null},y={id:null,name:null,description:null,adminCount:0,status:1},f={data:()=>({config:m,listQuery:Object.assign({},g),list:null,total:null,listLoading:!1,dialogVisible:!1,role:Object.assign({},y),isEdit:!1}),created(){this.getList()},filters:{formatDateTime(e){if(null==e||""===e)return"N/A";let t=new Date(e);return formatDate(t,"yyyy-MM-dd hh:mm:ss")}},methods:{handleResetSearch(){this.listQuery=Object.assign({},g)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.dialogVisible=!0,this.isEdit=!1,this.role=Object.assign({},y)},handleStatusChange(t,l){e(t.id,{status:t.status}).then((e=>{this.$message({type:"success",message:"修改成功!"})})),this.getList()},handleDelete({row:e,index:l}){this.$confirm("是否要删除该角色?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let l=[];l.push(e.id);let a=new FormData;a.append("ids",l),t(a).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))}))},handleUpdate({row:e,index:t}){this.dialogVisible=!0,this.isEdit=!0,this.role=JSON.parse(JSON.stringify(e)),console.log(this.role)},handleDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.isEdit?l(this.role.id,this.role).then((e=>{this.$message({message:"修改成功！",type:"success"}),this.dialogVisible=!1,this.getList()})):a(this.role).then((e=>{this.$message({message:"添加成功！",type:"success"}),this.dialogVisible=!1,this.getList()}))}))},handleSelectMenu({row:e,index:t}){this.$router.push({path:"/ums/allocMenu",query:{roleId:e.id}})},handleSelectResource({row:e,index:t}){this.$router.push({path:"/ums/allocResource",query:{roleId:e.id}})},getList(){this.listLoading=!0,i(this.listQuery).then((e=>{this.listLoading=!1,this.list=e.data.list,this.total=e.data.total}))}}},b={class:"app-container"},w={class:"operate-container"},V=u("div",null,[u("i",{class:"el-icon-search"}),u("span",null,"筛选搜索")],-1),S=c(" 查询搜索 "),x=c(" 重置 "),C={style:{"margin-top":"15px"}},_={class:"screenForm"},v={class:"operate-container"},L=u("div",null,[u("i",{class:"el-icon-tickets"}),u("span",null,"数据列表")],-1),O=c(" 添加 "),T=c("是"),k=c("否"),D=c("取 消"),Q=c("确 定");f.render=function(e,t,l,a,i,c){const m=s("el-button"),g=s("el-input"),y=s("el-form-item"),f=s("el-form"),U=s("el-card"),N=s("powerful-table"),$=s("el-radio"),j=s("el-radio-group"),R=s("el-drawer");return o(),n("div",b,[d(U,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:r((()=>[u("div",w,[V,u("div",null,[d(m,{style:{float:"right"},type:"primary",onClick:t[0]||(t[0]=e=>c.getList())},{default:r((()=>[S])),_:1}),d(m,{style:{float:"right","margin-right":"15px"},onClick:t[1]||(t[1]=e=>c.handleResetSearch())},{default:r((()=>[x])),_:1})])]),u("div",C,[d(f,{inline:!0,model:i.listQuery},{default:r((()=>[u("div",_,[d(y,{label:"角色名："},{default:r((()=>[d(g,{modelValue:i.listQuery.keyword,"onUpdate:modelValue":t[2]||(t[2]=e=>i.listQuery.keyword=e),placeholder:"角色名称",clearable:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),d(U,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:r((()=>[u("div",v,[L,u("div",null,[d(m,{type:"primary",class:"btn-add",onClick:t[3]||(t[3]=e=>c.handleAdd()),size:"mini"},{default:r((()=>[O])),_:1})])])])),_:1},8,["shadow"]),d(U,{shadow:e.defaultData.cardShadow},{default:r((()=>[u("div",null,[d(N,{ref:"menuTable",list:i.list,header:i.config,isSelect:!1,total:i.total,tableName:"table",onSizeChange:c.getList,onSwitchChange:c.handleStatusChange,onOccupyOne:c.handleSelectMenu,onOccupyTwo:c.handleSelectResource,onUpdate:c.handleUpdate,onRemove:c.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onOccupyOne","onOccupyTwo","onUpdate","onRemove"])])])),_:1},8,["shadow"]),d(R,{title:i.isEdit?"修改":"添加",modelValue:i.dialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>i.dialogVisible=e),direction:"rtl",ref:"drawer"},{default:r((()=>[d(f,{model:i.role,ref:"roleForm","label-width":"150px"},{default:r((()=>[d(y,{label:"角色名称："},{default:r((()=>[d(g,{modelValue:i.role.name,"onUpdate:modelValue":t[4]||(t[4]=e=>i.role.name=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),d(y,{label:"描述："},{default:r((()=>[d(g,{modelValue:i.role.description,"onUpdate:modelValue":t[5]||(t[5]=e=>i.role.description=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),d(y,{label:"是否启用："},{default:r((()=>[i.dialogVisible?(o(),p(j,{key:0,modelValue:i.role.status,"onUpdate:modelValue":t[6]||(t[6]=e=>i.role.status=e)},{default:r((()=>[d($,{label:1},{default:r((()=>[T])),_:1}),d($,{label:0},{default:r((()=>[k])),_:1})])),_:1},8,["modelValue"])):h("",!0)])),_:1}),d(y,null,{default:r((()=>[d(j,{modelValue:i.role.status,"onUpdate:modelValue":t[9]||(t[9]=e=>i.role.status=e)},{default:r((()=>[d(m,{onClick:t[7]||(t[7]=e=>i.dialogVisible=!1)},{default:r((()=>[D])),_:1}),d(m,{type:"primary",onClick:t[8]||(t[8]=e=>c.handleDialogConfirm())},{default:r((()=>[Q])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"])])};export default f;
