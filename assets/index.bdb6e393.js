import{u as e,b as l,c as a,e as t,f as i,h as s,i as o}from"./index.655b4610.js";import{f as d}from"./role.d1510095.js";import{r as n,o as u,c as m,a as r,w as h,i as p,m as c,k as g,F as f,g as y,K as b}from"./vendor.305ffdb2.js";const V=[{label:"编号",minWidth:"80",sortable:!0,props:[{prop:"id"}]},{label:"帐号",overflowTooltip:!0,props:[{prop:"username"}]},{label:"姓名",props:[{prop:"nickName"}]},{label:"邮箱",props:[{prop:"email"}]},{label:"添加时间",props:[{prop:"createTime"}]},{label:"最后登录",props:[{prop:"loginTime"}]},{label:"是否启用",props:[{prop:"status",type:"switch",data:{activeColor:"store.getter.themeColo",inactiveText:"隐",activeText:"显"}}]},{label:"操作",minWidth:"180px",props:[{type:"btn",data:[{tip:"分配角色",type:"primary",icon:"el-icon-user",emit:"occupyOne"},{tip:"编辑",type:"info",icon:"el-icon-edit-outline",emit:"update"},{tip:"删除",type:"danger",icon:"el-icon-delete",emit:"remove"}]}]}],w={pageNum:1,pageSize:10,keyword:null},_={id:null,username:null,password:null,nickName:null,email:null,note:null,status:1},x={data:()=>({config:V,listQuery:Object.assign({},w),list:null,total:null,listLoading:!1,dialogVisible:!1,admin:Object.assign({},_),isEdit:!1,allocDialogVisible:!1,allocRoleIds:[],allRoleList:[],allocAdminId:null}),created(){this.getList(),this.getAllRoleList()},filters:{formatDateTime(e){if(null==e||""===e)return"N/A";let l=new Date(e);return formatDate(l,"yyyy-MM-dd hh:mm:ss")}},methods:{handleResetSearch(){this.listQuery=Object.assign({},w)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.dialogVisible=!0,this.isEdit=!1,this.admin=Object.assign({},_)},handleStatusChange(l,a){e(l.id,{status:l.status}).then((e=>{this.$message({type:"success",message:"修改成功!"}),this.getList()}))},handleDelete({row:e,index:a}){l(e.id).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))},handleUpdate({row:e,index:l}){this.dialogVisible=!0,this.isEdit=!0,this.admin=Object.assign({},e)},handleDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.isEdit?a(this.admin.id,this.admin).then((e=>{this.$message({message:"修改成功！",type:"success"}),this.dialogVisible=!1,this.getList()})):t(this.admin).then((e=>{this.$message({message:"添加成功！",type:"success"}),this.dialogVisible=!1,this.getList()}))}))},handleAllocDialogConfirm(){this.$confirm("是否要确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=new FormData;e.append("adminId",this.allocAdminId),e.append("roleIds",this.allocRoleIds),i(e).then((e=>{this.$message({message:"分配成功！",type:"success"}),this.allocDialogVisible=!1}))}))},handleSelectRole({row:e,index:l}){this.allocAdminId=e.id,this.allocDialogVisible=!0,this.getRoleListByAdmin(e.id)},getList(){this.listLoading=!0,s(this.listQuery).then((e=>{this.listLoading=!1,this.list=e.data.list,this.total=e.data.total}))},getAllRoleList(){d().then((e=>{this.allRoleList=e.data}))},getRoleListByAdmin(e){o(e).then((e=>{let l=e.data;if(this.allocRoleIds=[],null!=l&&l.length>0)for(let a=0;a<l.length;a++)this.allocRoleIds.push(l[a].id)}))}}},C={class:"app-container"},L={class:"operate-container"},v=p("div",null,[p("i",{class:"el-icon-search"}),p("span",null,"筛选搜索")],-1),D=b(" 查询搜索 "),R=b(" 重置 "),k={style:{"margin-top":"15px"}},S={class:"screenForm"},U={class:"operate-container"},A=p("div",null,[p("i",{class:"el-icon-tickets"}),p("span",null,"数据列表")],-1),T=b(" 添加 "),I=b("是"),N=b("否"),O=b("取 消"),Q=b("确 定"),j=b("取 消"),B=b("确 定");x.render=function(e,l,a,t,i,s){const o=n("el-button"),d=n("el-input"),b=n("el-form-item"),V=n("el-form"),w=n("el-card"),_=n("powerful-table"),x=n("el-radio"),$=n("el-radio-group"),z=n("el-dialog"),E=n("el-option"),F=n("el-select");return u(),m("div",C,[r(w,{class:"filter-container",style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:h((()=>[p("div",L,[v,p("div",null,[r(o,{style:{float:"right"},type:"primary",onClick:l[0]||(l[0]=e=>s.getList())},{default:h((()=>[D])),_:1}),r(o,{style:{float:"right","margin-right":"15px"},onClick:l[1]||(l[1]=e=>s.handleResetSearch())},{default:h((()=>[R])),_:1})])]),p("div",k,[r(V,{inline:!0,model:i.listQuery},{default:h((()=>[p("div",S,[r(b,{label:"输入搜索："},{default:h((()=>[r(d,{modelValue:i.listQuery.keyword,"onUpdate:modelValue":l[2]||(l[2]=e=>i.listQuery.keyword=e),class:"input-width",placeholder:"帐号/姓名",clearable:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),r(w,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:h((()=>[p("div",U,[A,p("div",null,[r(o,{type:"primary",class:"btn-add",onClick:l[3]||(l[3]=e=>s.handleAdd()),size:"mini"},{default:h((()=>[T])),_:1})])])])),_:1},8,["shadow"]),r(w,{shadow:e.defaultData.cardShadow},{default:h((()=>[p("div",null,[r(_,{ref:"menuTable",list:i.list,header:i.config,isSelect:!1,total:i.total,tableName:"menuTable",onSizeChange:s.getList,onSwitchChange:s.handleStatusChange,onOccupyOne:s.handleSelectRole,onUpdate:s.handleUpdate,onRemove:s.handleDelete},null,8,["list","header","total","onSizeChange","onSwitchChange","onOccupyOne","onUpdate","onRemove"])])])),_:1},8,["shadow"]),r(z,{title:i.isEdit?"编辑用户":"添加用户",modelValue:i.dialogVisible,"onUpdate:modelValue":l[12]||(l[12]=e=>i.dialogVisible=e),width:"40%"},{default:h((()=>[r(V,{model:i.admin,ref:"adminForm","label-width":"150px"},{default:h((()=>[r(b,{label:"帐号："},{default:h((()=>[r(d,{modelValue:i.admin.username,"onUpdate:modelValue":l[4]||(l[4]=e=>i.admin.username=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(b,{label:"姓名："},{default:h((()=>[r(d,{modelValue:i.admin.nickName,"onUpdate:modelValue":l[5]||(l[5]=e=>i.admin.nickName=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(b,{label:"邮箱："},{default:h((()=>[r(d,{modelValue:i.admin.email,"onUpdate:modelValue":l[6]||(l[6]=e=>i.admin.email=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(b,{label:"密码："},{default:h((()=>[r(d,{modelValue:i.admin.password,"onUpdate:modelValue":l[7]||(l[7]=e=>i.admin.password=e),type:"password",style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(b,{label:"备注："},{default:h((()=>[r(d,{modelValue:i.admin.note,"onUpdate:modelValue":l[8]||(l[8]=e=>i.admin.note=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),r(b,{label:"是否启用："},{default:h((()=>[i.dialogVisible?(u(),c($,{key:0,modelValue:i.admin.status,"onUpdate:modelValue":l[9]||(l[9]=e=>i.admin.status=e)},{default:h((()=>[r(x,{label:1},{default:h((()=>[I])),_:1}),r(x,{label:0},{default:h((()=>[N])),_:1})])),_:1},8,["modelValue"])):g("",!0)])),_:1}),r(b,null,{default:h((()=>[r(o,{onClick:l[10]||(l[10]=e=>i.dialogVisible=!1)},{default:h((()=>[O])),_:1}),r(o,{type:"primary",onClick:l[11]||(l[11]=e=>s.handleDialogConfirm())},{default:h((()=>[Q])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue"]),r(z,{title:"分配角色",modelValue:i.allocDialogVisible,"onUpdate:modelValue":l[16]||(l[16]=e=>i.allocDialogVisible=e),width:"30%"},{footer:h((()=>[r(o,{onClick:l[14]||(l[14]=e=>i.allocDialogVisible=!1)},{default:h((()=>[j])),_:1}),r(o,{type:"primary",onClick:l[15]||(l[15]=e=>s.handleAllocDialogConfirm())},{default:h((()=>[B])),_:1})])),default:h((()=>[r(F,{modelValue:i.allocRoleIds,"onUpdate:modelValue":l[13]||(l[13]=e=>i.allocRoleIds=e),multiple:"",placeholder:"请选择",style:{width:"80%"}},{default:h((()=>[(u(!0),m(f,null,y(i.allRoleList,(e=>(u(),c(E,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])};export default x;
