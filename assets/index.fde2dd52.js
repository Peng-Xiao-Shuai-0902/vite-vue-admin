import{u as e,c as t,d as l,a,l as s}from"./resource.7897b68c.js";import{h as r}from"./indexData.2a8cd762.js";import{_ as i,r as o,o as d,l as n,w as u,a as c,c as m,g as h,F as p,k as g,L as y,i as f}from"./vendor.28d90a97.js";import"./index.de99b198.js";const b={props:{dialog:{type:Boolean,default:!1},currentFrom:{type:Object,default:()=>{}},selectMenuList:{type:Array,default:()=>[]}},data:()=>({}),emits:["update:currentFrom","update:dialog","refresh"],methods:{close(){this.$emit("update:dialog",!1)},onSubmit(l){this.$refs[l].validate((a=>{if(!a)return this.$message({message:"验证失败",type:"error",duration:1e3}),!1;this.$confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{!!this.currentFrom.id?e(this.currentFrom.id,this.currentFrom).then((e=>{this.$message({message:"修改成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})):t(this.currentFrom).then((e=>{this.$refs[l].resetFields(),this.resetForm(l),this.$message({message:"提交成功",type:"success",duration:1e3}),this.$emit("update:dialog",!1)})),setTimeout((()=>{this.$emit("refresh")}),200)}))}))},resetForm(e){this.$refs[e].resetFields(),this.$emit("update:currentFrom",{id:null})}}},w=y("提交"),F=y("重置");const V={pageNum:1,pageSize:10,nameKeyword:null,urlKeyword:null,categoryId:null},v={id:null,name:null,url:null,categoryId:null,description:""},_={components:{update:i(b,[["render",function(e,t,l,a,s,r){const i=o("el-input"),y=o("el-form-item"),f=o("el-option"),b=o("el-select"),V=o("el-button"),v=o("el-form"),_=o("el-drawer");return d(),n(_,{title:l.currentFrom.id?"修改":"添加",modelValue:l.dialog,"onUpdate:modelValue":t[6]||(t[6]=e=>l.dialog=e),direction:"rtl",ref:"drawer",onClose:r.close},{default:u((()=>[c(v,{model:l.currentFrom,ref:"From","label-width":"100px",style:{padding:"0 20px"}},{default:u((()=>[c(y,{label:"资源名称："},{default:u((()=>[c(i,{modelValue:l.currentFrom.name,"onUpdate:modelValue":t[0]||(t[0]=e=>l.currentFrom.name=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),c(y,{label:"资源路径："},{default:u((()=>[c(i,{modelValue:l.currentFrom.url,"onUpdate:modelValue":t[1]||(t[1]=e=>l.currentFrom.url=e),style:{width:"250px"}},null,8,["modelValue"])])),_:1}),c(y,{label:"资源分类："},{default:u((()=>[c(b,{modelValue:l.currentFrom.categoryId,"onUpdate:modelValue":t[2]||(t[2]=e=>l.currentFrom.categoryId=e),placeholder:"全部",clearable:"",style:{width:"250px"}},{default:u((()=>[(d(!0),m(p,null,h(l.selectMenuList,(e=>(d(),n(f,{key:e.label,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),c(y,{label:"描述："},{default:u((()=>[c(i,{modelValue:l.currentFrom.description,"onUpdate:modelValue":t[3]||(t[3]=e=>l.currentFrom.description=e),type:"textarea",rows:5,style:{width:"250px"}},null,8,["modelValue"])])),_:1}),c(y,null,{default:u((()=>[c(V,{type:"primary",onClick:t[4]||(t[4]=e=>r.onSubmit("From"))},{default:u((()=>[w])),_:1}),l.currentFrom.id?g("",!0):(d(),n(V,{key:0,onClick:t[5]||(t[5]=e=>r.resetForm("From"))},{default:u((()=>[F])),_:1}))])),_:1})])),_:1},8,["model"])])),_:1},8,["title","modelValue","onClose"])}]])},data:()=>({config:r,listQuery:Object.assign({},V),list:null,total:null,listLoading:!1,isDialog:!1,resource:Object.assign({},v),isEdit:!1,categoryOptions:[],defaultCategoryId:null}),created(){this.getList(),this.getCateList()},methods:{handleResetSearch(){this.listQuery=Object.assign({},V)},handleSearchList(){this.listQuery.pageNum=1,this.getList()},handleSizeChange(e){this.listQuery.pageNum=1,this.listQuery.pageSize=e,this.getList()},handleCurrentChange(e){this.listQuery.pageNum=e,this.getList()},handleAdd(){this.isDialog=!0,this.isEdit=!1,this.resource=Object.assign({},v),this.resource.categoryId=this.defaultCategoryId},handleDelete({row:e,index:t}){l(e.id).then((e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()}))},handleUpdate({row:e,index:t}){this.isDialog=!0,this.isEdit=!0,this.resource=Object.assign({},e)},handleShowCategory(){console.log(this.$router),this.$router.push({name:"resourceCategory"})},getList(e){this.isDialog=!1,Object.assign(this.listQuery,e||{}),a(this.listQuery).then((e=>{this.list=e.data.list,this.total=e.data.total}))},getCateList(){s().then((e=>{let t=e.data;for(let l=0;l<t.length;l++){let e=t[l];this.categoryOptions.push({label:e.name,value:e.id})}this.defaultCategoryId=t[0].id}))}}},C={class:"app-container"},x={class:"operate-container"},L=f("div",null,[f("i",{class:"el-icon-search"}),f("span",null,"筛选搜索")],-1),S=y(" 查询搜索 "),Q=y(" 重置 "),$={style:{"margin-top":"15px"}},U={class:"screenForm"},D={class:"operate-container"},j=f("div",null,[f("i",{class:"el-icon-tickets"}),f("span",null,"数据列表")],-1),k=y(" 添加 "),O=y(" 资源分类 ");var I=i(_,[["render",function(e,t,l,a,s,r){const i=o("el-button"),g=o("el-input"),y=o("el-form-item"),b=o("el-option"),w=o("el-select"),F=o("el-form"),V=o("el-card"),v=o("powerful-table"),_=o("update");return d(),m("div",C,[c(V,{style:{marginBottom:"20px"},class:"filter-container",shadow:e.defaultData.cardShadow},{default:u((()=>[f("div",x,[L,f("div",null,[c(i,{style:{float:"right"},type:"primary",onClick:t[0]||(t[0]=e=>r.getList())},{default:u((()=>[S])),_:1}),c(i,{style:{float:"right","margin-right":"15px"},onClick:t[1]||(t[1]=e=>r.handleResetSearch())},{default:u((()=>[Q])),_:1})])]),f("div",$,[c(F,{inline:!0,model:s.listQuery},{default:u((()=>[f("div",U,[c(y,{label:"资源名称："},{default:u((()=>[c(g,{modelValue:s.listQuery.nameKeyword,"onUpdate:modelValue":t[2]||(t[2]=e=>s.listQuery.nameKeyword=e),class:"input-width",placeholder:"资源名称",clearable:""},null,8,["modelValue"])])),_:1}),c(y,{label:"资源路径："},{default:u((()=>[c(g,{modelValue:s.listQuery.urlKeyword,"onUpdate:modelValue":t[3]||(t[3]=e=>s.listQuery.urlKeyword=e),class:"input-width",placeholder:"资源路径",clearable:""},null,8,["modelValue"])])),_:1}),c(y,{label:"资源分类："},{default:u((()=>[c(w,{modelValue:s.listQuery.categoryId,"onUpdate:modelValue":t[4]||(t[4]=e=>s.listQuery.categoryId=e),placeholder:"全部",clearable:"",class:"input-width"},{default:u((()=>[(d(!0),m(p,null,h(s.categoryOptions,(e=>(d(),n(b,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["model"])])])),_:1},8,["shadow"]),c(V,{style:{marginBottom:"20px"},shadow:e.defaultData.cardShadow},{default:u((()=>[f("div",D,[j,f("div",null,[c(i,{type:"primary",class:"btn-add",onClick:t[5]||(t[5]=e=>r.handleAdd()),size:"mini"},{default:u((()=>[k])),_:1}),c(i,{size:"mini",class:"btn-add",onClick:t[6]||(t[6]=e=>r.handleShowCategory())},{default:u((()=>[O])),_:1})])])])),_:1},8,["shadow"]),c(V,{shadow:e.defaultData.cardShadow},{default:u((()=>[f("div",null,[c(v,{ref:"menuTable",list:s.list,header:s.config,isSelect:!1,total:s.total,tableName:"menuTable",onSizeChange:r.getList,onUpdate:r.handleUpdate,onRemove:r.handleDelete},null,8,["list","header","total","onSizeChange","onUpdate","onRemove"])])])),_:1},8,["shadow"]),c(_,{dialog:s.isDialog,"onUpdate:dialog":t[7]||(t[7]=e=>s.isDialog=e),currentFrom:s.resource,"onUpdate:currentFrom":t[8]||(t[8]=e=>s.resource=e),selectMenuList:s.categoryOptions,onRefresh:r.getList},null,8,["dialog","currentFrom","selectMenuList","onRefresh"])])}]]);export default I;
