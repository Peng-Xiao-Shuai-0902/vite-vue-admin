import{d as g,r as i,t as $,A as k,_ as v,o as C,f as w,k as _,a0 as y,g as r,w as p,j as m,l as E,E as M}from"./index-234e01e2.js";const U=g({props:{modelValue:String,signColor:String,signBgColor:String},emits:["update:modelValue","success"],setup(e,n){let t,s,a,d,l=i(null);const o=i(""),c=i(!1),h="sign"+new Date().getTime();$(()=>{t=document.getElementById(h),t&&(a=t.offsetWidth,d=t.offsetHeight,t.width=a,t.height=d,s=t.getContext("2d"),l.value=s,s.fillStyle=e.signColor||"#fff",s.fillRect(0,0,a,a),s.save(),s.strokeStyle=e.signBgColor||"#000",s.lineWidth=1)});const f=i(!1);return{handleDown:u=>{s.beginPath(),s.moveTo(u.offsetX,u.offsetY),f.value=!0},handleMove:u=>{f.value&&(s.lineTo(u.offsetX,u.offsetY),s.stroke())},handleUp:()=>{f.value=!1},handleClear:()=>{s.clearRect(0,0,a,d)},handleCreateImg:()=>{o.value=t.toDataURL("image/jpeg"),o.value&&(k.success("生成图片成功！"),n.emit("update:modelValue",o.value),n.emit("success",o.value))},id:h,ctxRef:l,baseUrl:o,isDialog:c}}}),V={style:{width:"100%",position:"relative"}},B=["id"];function D(e,n,t,s,a,d){const l=E;return C(),w("div",V,[_("canvas",{id:e.id,onMousedown:n[0]||(n[0]=(...o)=>e.handleDown&&e.handleDown(...o)),onMousemove:n[1]||(n[1]=(...o)=>e.handleMove&&e.handleMove(...o)),onMouseup:n[2]||(n[2]=(...o)=>e.handleUp&&e.handleUp(...o)),onMouseleave:n[3]||(n[3]=(...o)=>e.handleUp&&e.handleUp(...o)),style:{width:"100%",height:"400px",border:"1px solid #000"}},null,40,B),y(e.$slots,"default",{ctx:e.ctxRef},()=>[r(l,{type:"primary",onClick:e.handleClear},{default:p(()=>[m("清除画布")]),_:1},8,["onClick"]),r(l,{type:"primary",onClick:e.handleCreateImg},{default:p(()=>[m("生成图片")]),_:1},8,["onClick"])])])}const S=v(U,[["render",D]]),R=g({components:{CanvasSign:S},setup(){return{url:i(""),handleSuccess:t=>{}}}}),T={class:"app-container"};function b(e,n,t,s,a,d){const l=S,o=M;return C(),w("div",T,[r(o,{shadow:e.defaultData.cardShadow},{default:p(()=>[r(l,{modelValue:e.url,"onUpdate:modelValue":n[0]||(n[0]=c=>e.url=c),onSuccess:e.handleSuccess},null,8,["modelValue","onSuccess"])]),_:1},8,["shadow"])])}const Y=v(R,[["render",b]]);export{Y as default};
